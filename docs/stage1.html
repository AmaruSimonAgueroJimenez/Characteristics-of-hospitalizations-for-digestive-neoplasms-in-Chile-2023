<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="María Fernanda Gallego Muga">
<meta name="author" content="Gregorio Palacios Pino">
<meta name="author" content="Valentina Meilan Ip Francesconi">
<meta name="author" content="Amaru Simón Agüero Jiménez">

<title>Characteristics of Hospitalization (length of stay, mortality, and comorbidities) for Patients with Stomach, Colorectal, Pancreatic, and Gallbladder Cancers in Chile, 2019-2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="stage1_files/libs/clipboard/clipboard.min.js"></script>
<script src="stage1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="stage1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="stage1_files/libs/quarto-html/popper.min.js"></script>
<script src="stage1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="stage1_files/libs/quarto-html/anchor.min.js"></script>
<link href="stage1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="stage1_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="stage1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="stage1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="stage1_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<script src="stage1_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="stage1_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#abstract-pxdecease" id="toc-abstract-pxdecease" class="nav-link active" data-scroll-target="#abstract-pxdecease"><span class="header-section-number">1</span> Abstract (P(X=Decease))</a></li>
  <li><a href="#abstract-los" id="toc-abstract-los" class="nav-link" data-scroll-target="#abstract-los"><span class="header-section-number">2</span> Abstract (LOS)</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">3</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">4</span> Methods</a>
  <ul>
  <li><a href="#study-design-and-data-source" id="toc-study-design-and-data-source" class="nav-link" data-scroll-target="#study-design-and-data-source"><span class="header-section-number">4.1</span> Study Design and Data Source</a></li>
  <li><a href="#cancer-case-identification" id="toc-cancer-case-identification" class="nav-link" data-scroll-target="#cancer-case-identification"><span class="header-section-number">4.2</span> Cancer Case Identification</a></li>
  <li><a href="#lifestyle-related-comorbidity-classification" id="toc-lifestyle-related-comorbidity-classification" class="nav-link" data-scroll-target="#lifestyle-related-comorbidity-classification"><span class="header-section-number">4.3</span> Lifestyle-Related Comorbidity Classification</a></li>
  <li><a href="#statistical-analyses" id="toc-statistical-analyses" class="nav-link" data-scroll-target="#statistical-analyses"><span class="header-section-number">4.4</span> Statistical Analyses</a>
  <ul>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">4.4.1</span> Descriptive Statistics</a></li>
  <li><a href="#bivariate-associations" id="toc-bivariate-associations" class="nav-link" data-scroll-target="#bivariate-associations"><span class="header-section-number">4.4.2</span> Bivariate Associations</a></li>
  <li><a href="#mixed-effects-logistic-regression" id="toc-mixed-effects-logistic-regression" class="nav-link" data-scroll-target="#mixed-effects-logistic-regression"><span class="header-section-number">4.4.3</span> Mixed-Effects Logistic Regression</a></li>
  <li><a href="#negative-binomial-mixed-models" id="toc-negative-binomial-mixed-models" class="nav-link" data-scroll-target="#negative-binomial-mixed-models"><span class="header-section-number">4.4.4</span> Negative Binomial Mixed Models</a></li>
  <li><a href="#model-performance-assessment" id="toc-model-performance-assessment" class="nav-link" data-scroll-target="#model-performance-assessment"><span class="header-section-number">4.4.5</span> Model Performance Assessment</a></li>
  <li><a href="#measures-of-explained-variation" id="toc-measures-of-explained-variation" class="nav-link" data-scroll-target="#measures-of-explained-variation"><span class="header-section-number">4.4.6</span> Measures of Explained Variation</a></li>
  <li><a href="#additional-performance-metrics" id="toc-additional-performance-metrics" class="nav-link" data-scroll-target="#additional-performance-metrics"><span class="header-section-number">4.4.7</span> Additional Performance Metrics</a></li>
  </ul></li>
  <li><a href="#sensitivity-analyses" id="toc-sensitivity-analyses" class="nav-link" data-scroll-target="#sensitivity-analyses"><span class="header-section-number">4.5</span> Sensitivity Analyses</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">5</span> Results</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Characteristics of Hospitalization (length of stay, mortality, and comorbidities) for Patients with Stomach, Colorectal, Pancreatic, and Gallbladder Cancers in Chile, 2019-2023</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autores/as</div>
    <div class="quarto-title-meta-contents">
             <p>María Fernanda Gallego Muga <a href="mailto:maria.gallego.muga@ug.uchile.cl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0000-0000-0000" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Gregorio Palacios Pino <a href="mailto:gregorio.palacios@ug.uchile.cl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0000-0000-0000" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Valentina Meilan Ip Francesconi <a href="mailto:valentina.ip@ug.uchile.cl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0000-0000-0000" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Amaru Simón Agüero Jiménez <a href="mailto:aaguero@miaundes.cl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-7336-1833" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">1 de septiembre de 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="abstract-pxdecease" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Abstract (P(X=Decease))</h1>
</section>
<section id="abstract-los" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Abstract (LOS)</h1>
</section>
<section id="introduction" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Introduction</h1>
<p>In-hospital survival, the probability of discharge alive during a specific hospitalization, offers a pragmatic, short‑term outcome that integrates baseline disease severity at admission and the balance between medical–surgical effectiveness and complications during care. For digestive organ malignancies, this metric complements long-term survival by reflecting acute physiology, intercurrent complications, and differences in hospital processes of care that may vary by sector (public/private) and region.</p>
<p>Gastrointestinal (GI) cancers collectively account for approximately 26% of incident cancers and 35% of cancer deaths worldwide, underscoring their disproportionate lethality<span class="citation" data-cites="Arnold2020"><sup><a href="#ref-Arnold2020" role="doc-biblioref">1</a></sup></span>. Within this group, colorectal cancer (CRC) shows rising incidence in many countries and in younger cohorts, a pattern closely linked to lifestyle and metabolic exposures<span class="citation" data-cites="Keum2019"><sup><a href="#ref-Keum2019" role="doc-biblioref">2</a></sup></span>. In Chile, CRC incidence, mortality, and hospital discharges have increased over the past decade, with marked geographic and socioeconomic gradients in survival and access to higher‑complexity centers<span class="citation" data-cites="Mondschein2022 Rios2020"><sup><a href="#ref-Mondschein2022" role="doc-biblioref">3</a>,<a href="#ref-Rios2020" role="doc-biblioref">4</a></sup></span>. Gastric cancer remains a leading cause of cancer death in Chile and continues to present at advanced stages despite secular declines in many settings<span class="citation" data-cites="Caglevic2016"><sup><a href="#ref-Caglevic2016" role="doc-biblioref">5</a></sup></span>. Pancreatic cancer, characterized by high case‑fatality, has shown increasing burden globally, with only modest improvements in outcomes<span class="citation" data-cites="Arnold2020 GBD2017_Pancreas2019"><sup><a href="#ref-Arnold2020" role="doc-biblioref">1</a>,<a href="#ref-GBD2017_Pancreas2019" role="doc-biblioref">6</a></sup></span>. Gallbladder cancer exhibits a unique Chilean footprint,among the highest incidence and mortality worldwide, shaped by gallstone prevalence, obesity, female predominance, and ethnic/territorial patterns, particularly in the south<span class="citation" data-cites="Olivares2016 Koshiol2020"><sup><a href="#ref-Olivares2016" role="doc-biblioref">7</a>,<a href="#ref-Koshiol2020" role="doc-biblioref">8</a></sup></span>.</p>
<p>A lifestyle‑medicine lens is essential for these neoplasms because a substantial share of cancer burden is attributable to modifiable exposures, and multicomponent behavioral change can lower risk across sites. The World Cancer Research Fund/AICR Third Expert Report synthesizes convergent evidence that diet quality, body fatness, and physical activity exert causal effects for several GI cancers, with strong or probable evidence for specific factors (e.g., body fatness, processed/red meat, alcohol, dietary fiber, whole grains, and physical activity in CRC)<span class="citation" data-cites="WCRF2018 WCRF2018_CRC Bouvard2015"><sup><a href="#ref-WCRF2018" role="doc-biblioref">9</a>–<a href="#ref-Bouvard2015" role="doc-biblioref">11</a></sup></span>. Independently, the IARC Working Group concludes that body fatness is causally linked to multiple digestive cancers—including CRC, gastric cardia, pancreas, and gallbladder—via endocrine, inflammatory, and insulin/IGF‑1 pathways<span class="citation" data-cites="LaubySecretan2016"><sup><a href="#ref-LaubySecretan2016" role="doc-biblioref">12</a></sup></span>. Alcohol confers dose‑dependent increases in risk for several digestive sites, including colorectum and liver, with accumulating evidence for pancreas; the most comprehensive dose–response meta‑analysis quantifies these gradients across 23 cancer types<span class="citation" data-cites="Bagnardi2015"><sup><a href="#ref-Bagnardi2015" role="doc-biblioref">13</a></sup></span>. For gastric cancer, <em>Helicobacter pylori</em> eradication reduces incidence in randomized trials and is endorsed as a population‑level prevention strategy in high‑risk contexts, while dietary salt reduction and weight management may further attenuate risk<span class="citation" data-cites="IARC2014 Ford2014"><sup><a href="#ref-IARC2014" role="doc-biblioref">14</a>,<a href="#ref-Ford2014" role="doc-biblioref">15</a></sup></span>.</p>
<p>Chile’s cardiometabolic risk profile amplifies this etiologic substrate. The Third National Health Survey (ENS 2016–2017) documents high prevalence of excess adiposity alongside gains in tobacco control, patterns that co‑travel with hypertension, diabetes, and dyslipidemia and may compound peri‑operative risk, length of stay, and in‑hospital mortality for digestive cancers<span class="citation" data-cites="Bachelet2018"><sup><a href="#ref-Bachelet2018" role="doc-biblioref">16</a></sup></span>. At a global level, WHO estimates indicate that between one‑third and one‑half of cancers are preventable through risk‑factor modification, principally tobacco control, healthy weight, diet quality, alcohol reduction, and physical activity, reinforcing the public‑health salience of lifestyle‑based interventions across the cancer continuum<span class="citation" data-cites="WHO2025"><sup><a href="#ref-WHO2025" role="doc-biblioref">17</a></sup></span>.</p>
<p>Beyond incidence and aetiology, in‑hospital survival is tightly entwined with hospital length of stay (LOS), which captures recovery velocity, complication burden, and discharge readiness. In Chilean CRC cohorts implementing Enhanced Recovery After Surgery (ERAS), median LOS declined from roughly five to three days without safety trade‑offs, despite high baseline comorbidity (hypertension ≈58%, diabetes ≈22%)<span class="citation" data-cites="MartinezMardones2022_RevCir"><sup><a href="#ref-MartinezMardones2022_RevCir" role="doc-biblioref">18</a></sup></span>. Contemporary multicentre series internationally report a median LOS near four days (mean ≈7) after colorectal resection, with prolonged LOS largely driven by postoperative complications such as anastomotic leak<span class="citation" data-cites="Huisman2024_AOSOpen"><sup><a href="#ref-Huisman2024_AOSOpen" role="doc-biblioref">19</a></sup></span>. For gastric cancer, Chilean experience with totally laparoscopic gastrectomy shows a median LOS around seven days, comparable to the Western LOGICA randomized trial in which laparoscopic and open gastrectomy both achieved a median of seven days, underscoring the roles of peri‑operative pathways and case mix beyond approach alone<span class="citation" data-cites="Norero2015_RevMedChile vanDerVeen2021_LOGICA"><sup><a href="#ref-Norero2015_RevMedChile" role="doc-biblioref">20</a>,<a href="#ref-vanDerVeen2021_LOGICA" role="doc-biblioref">21</a></sup></span>. Pancreatic resections remain the outlier for LOS: Chilean series of pancreatoduodenectomy report means approaching two weeks, reflecting the intrinsic morbidity of pancreatic surgery; nonetheless, randomized data in distal pancreatectomy and ERAS‑focused meta‑analyses demonstrate that minimally invasive techniques and standardized pathways can shorten LOS without compromising safety<span class="citation" data-cites="Losada2024_RevCir_Blumgart Bjornsson2020_LAPOP Kuemmerli2022_BJS Melloul2020_ERAS_PDAC"><sup><a href="#ref-Losada2024_RevCir_Blumgart" role="doc-biblioref">22</a>–<a href="#ref-Melloul2020_ERAS_PDAC" role="doc-biblioref">25</a></sup></span>. In gallbladder cancer, where Chile bears a singular burden, the extent of liver resection correlates with morbidity and convalescence; in selected incidental gallbladder cancers, minimally invasive extended cholecystectomy can reduce LOS relative to open surgery in experienced centres<span class="citation" data-cites="Vega2023_ASO_IGBC Nakanishi2022_AJS Lee2022_LapExtendedChole Zeng2024_FrontSurg"><sup><a href="#ref-Vega2023_ASO_IGBC" role="doc-biblioref">26</a>–<a href="#ref-Zeng2024_FrontSurg" role="doc-biblioref">29</a></sup></span>. More broadly across GI operations, ERAS guideline adherence is associated with LOS reductions on the order of two days in randomized evidence syntheses<span class="citation" data-cites="Sauro2024_JAMAOpen"><sup><a href="#ref-Sauro2024_JAMAOpen" role="doc-biblioref">30</a></sup></span>.</p>
<p>Lifestyle‑related comorbidities function as consistent modifiers of LOS and near‑term outcomes across digestive cancers. Diabetes mellitus independently increases the odds of prolonged LOS, 90‑day readmission, and short‑term mortality after colorectal resection in national cohorts, while higher Charlson Comorbidity Index scores are linearly associated with longer LOS and in‑hospital death following CRC surgery<span class="citation" data-cites="Gysling2024_AOSOpen Zhang2023_CMRO Tian2017_CCI_CRC"><sup><a href="#ref-Gysling2024_AOSOpen" role="doc-biblioref">31</a>–<a href="#ref-Tian2017_CCI_CRC" role="doc-biblioref">33</a></sup></span>. Obesity reliably increases surgical‑site infection after CRC and is linked to longer LOS in settings without robust ERAS implementation; however, within structured ERAS programmes, the LOS penalty attributable to obesity often attenuates<span class="citation" data-cites="Gurunathan2017_JOGS Irani2023_ASCRS"><sup><a href="#ref-Gurunathan2017_JOGS" role="doc-biblioref">34</a>,<a href="#ref-Irani2023_ASCRS" role="doc-biblioref">35</a></sup></span>. For gastrectomy, elevated BMI increases operative complexity and overall complications with heterogeneous effects on LOS across systems<span class="citation" data-cites="Tsekrekos2022_GastricBMI"><sup><a href="#ref-Tsekrekos2022_GastricBMI" role="doc-biblioref">36</a></sup></span>, and diabetes has been associated with slower postoperative recovery in some series<span class="citation" data-cites="Zhao2025_WJG"><sup><a href="#ref-Zhao2025_WJG" role="doc-biblioref">37</a></sup></span>. In pancreatic surgery, obesity is consistently associated with higher complication rates and often longer LOS, and meticulous glycaemic management is key to recovery trajectories, particularly after total pancreatectomy<span class="citation" data-cites="Ramsey2011_JOGS Hajibandeh2025_ObesityPancreatectomy Zhao2023_TP"><sup><a href="#ref-Ramsey2011_JOGS" role="doc-biblioref">38</a>–<a href="#ref-Zhao2023_TP" role="doc-biblioref">40</a></sup></span>. Taken together, these data reinforce the dual relevance of lifestyle medicine, both upstream (primary risk attenuation) and peri‑operative (prehabilitation, nutrition, physical activity, smoking/alcohol cessation, and glycaemic control), to shorten LOS and improve in‑hospital survival<span class="citation" data-cites="WCRF2018 Sauro2024_JAMAOpen WHO2025"><sup><a href="#ref-WCRF2018" role="doc-biblioref">9</a>,<a href="#ref-WHO2025" role="doc-biblioref">17</a>,<a href="#ref-Sauro2024_JAMAOpen" role="doc-biblioref">30</a></sup></span>.</p>
<p>Against this backdrop, quantifying and modeling in‑hospital survival for major digestive cancers—stomach, colorectal, pancreas, and gallbladder—in Chile (2019–2023), and evaluating the effect of coexisting lifestyle‑related comorbidities (hypertension, diabetes, dyslipidemia, and obesity), will fill a critical gap between etiologic/lifestyle knowledge and real‑world, short‑term outcomes. Such an approach can (i) stratify risk at admission, (ii) contextualize acute complications and fatality beyond staging alone, and (iii) generate actionable signals for hospital practice and prevention policy (screening and early detection, <em>H. pylori</em> strategies, diet/physical‑activity programs, alcohol and tobacco control) aligned with a lifestyle‑medicine framework<span class="citation" data-cites="WCRF2018 WCRF2018_CRC IARC2014"><sup><a href="#ref-WCRF2018" role="doc-biblioref">9</a>,<a href="#ref-WCRF2018_CRC" role="doc-biblioref">10</a>,<a href="#ref-IARC2014" role="doc-biblioref">14</a></sup></span>.</p>
</section>
<section id="methods" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Methods</h1>
<section id="study-design-and-data-source" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="study-design-and-data-source"><span class="header-section-number">4.1</span> Study Design and Data Source</h2>
<p>A retrospective cohort study was conducted using hospital discharge data from the Chilean public health system covering the period 2019-2023. All hospitalization records containing International Classification of Diseases, 10th Revision (ICD-10) codes for gastrointestinal cancers were extracted. The analysis focused on four primary cancer sites: stomach (C16), colorectal (C18-C20), pancreas (C25), and gallbladder (C23).</p>
</section>
<section id="cancer-case-identification" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="cancer-case-identification"><span class="header-section-number">4.2</span> Cancer Case Identification</h2>
<p>Cancer diagnoses were identified through systematic screening of all diagnostic fields (primary and secondary diagnoses, positions 1-35) in the discharge records. Cases were classified by primary cancer site based on the first occurrence of target ICD-10 codes in the diagnostic sequence. The diagnostic position was recorded to distinguish between primary admissions for cancer treatment and admissions where cancer was a secondary condition.</p>
</section>
<section id="lifestyle-related-comorbidity-classification" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="lifestyle-related-comorbidity-classification"><span class="header-section-number">4.3</span> Lifestyle-Related Comorbidity Classification</h2>
<p>Fifteen lifestyle-related comorbidity groups were defined based on ICD-10 codes, encompassing conditions associated with modifiable lifestyle factors<span class="citation" data-cites="ford2012"><sup><a href="#ref-ford2012" role="doc-biblioref">41</a></sup></span>. These groups included: obesity and overweight, dyslipidemia and metabolic disorders, diabetes and glucose disorders, hypertension, tobacco-related diseases, alcohol-related diseases, substance use disorders, nutritional deficiencies, non-alcoholic liver disease, sleep disorders, cardiovascular diseases, gastrointestinal disorders, musculoskeletal disorders related to sedentary behavior, and mental health conditions.</p>
<p>For each patient, the presence of each comorbidity group was coded as a binary variable, and the total comorbidity burden was calculated as:</p>
<p><span class="math display">\[N_{comorbidities} = \sum_{j=1}^{15} I_j\]</span></p>
<p>where <span class="math inline">\(I_j\)</span> is an indicator variable for the presence of comorbidity group <span class="math inline">\(j\)</span>.</p>
</section>
<section id="statistical-analyses" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="statistical-analyses"><span class="header-section-number">4.4</span> Statistical Analyses</h2>
<section id="descriptive-statistics" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">4.4.1</span> Descriptive Statistics</h3>
<p>Prevalence rates for each comorbidity were calculated by cancer site and discharge status (deceased vs.&nbsp;discharged alive). Temporal trends were assessed across the five-year study period.</p>
</section>
<section id="bivariate-associations" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="bivariate-associations"><span class="header-section-number">4.4.2</span> Bivariate Associations</h3>
<p>The association between each comorbidity and mortality was assessed using chi-square tests for expected cell frequencies ≥5 and Fisher’s exact test otherwise<span class="citation" data-cites="agresti2019"><sup><a href="#ref-agresti2019" role="doc-biblioref">42</a></sup></span>:</p>
<p><span class="math display">\[\chi^2 = \sum_{i,j} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}\]</span></p>
<p>where <span class="math inline">\(O_{ij}\)</span> and <span class="math inline">\(E_{ij}\)</span> are observed and expected frequencies in the contingency table.</p>
<p>Differences in length of stay (LOS) between patients with and without specific comorbidities were evaluated using the Wilcoxon rank-sum test<span class="citation" data-cites="hollander2013"><sup><a href="#ref-hollander2013" role="doc-biblioref">43</a></sup></span>, with the test statistic:</p>
<p><span class="math display">\[W = \sum_{i=1}^{n_1} R_i\]</span></p>
<p>where <span class="math inline">\(R_i\)</span> represents the rank of observation <span class="math inline">\(i\)</span> from the first group in the combined sample.</p>
</section>
<section id="mixed-effects-logistic-regression" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="mixed-effects-logistic-regression"><span class="header-section-number">4.4.3</span> Mixed-Effects Logistic Regression</h3>
<p>In-hospital mortality was modeled using generalized linear mixed models with a logit link function<span class="citation" data-cites="breslow1993"><sup><a href="#ref-breslow1993" role="doc-biblioref">44</a></sup></span>:</p>
<p><span class="math display">\[\log\left(\frac{\pi_{ij}}{1-\pi_{ij}}\right) = \beta_0 + \mathbf{x}_{ij}^T\boldsymbol{\beta} + u_j\]</span></p>
<p>where <span class="math inline">\(\pi_{ij}\)</span> is the probability of death for patient <span class="math inline">\(i\)</span> in year <span class="math inline">\(j\)</span>, <span class="math inline">\(\mathbf{x}_{ij}\)</span> is the vector of covariates including age, sex, admission service category, severity indices, and significant comorbidities, <span class="math inline">\(\boldsymbol{\beta}\)</span> is the vector of fixed effects, and <span class="math inline">\(u_j \sim N(0, \sigma^2_u)\)</span> represents the random year effect.</p>
<p>Only comorbidities showing significant association (<span class="math inline">\(p &lt; 0.05\)</span>) in bivariate analysis were included in the final models to avoid overfitting<span class="citation" data-cites="harrell2015"><sup><a href="#ref-harrell2015" role="doc-biblioref">45</a></sup></span>. The models were fitted using the Laplace approximation with the BOBYQA optimizer.</p>
</section>
<section id="negative-binomial-mixed-models" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="negative-binomial-mixed-models"><span class="header-section-number">4.4.4</span> Negative Binomial Mixed Models</h3>
<p>Length of stay was modeled using negative binomial mixed models to account for overdispersion<span class="citation" data-cites="hilbe2011"><sup><a href="#ref-hilbe2011" role="doc-biblioref">46</a></sup></span>:</p>
<p><span class="math display">\[\log(\mu_{ij}) = \beta_0 + \mathbf{x}_{ij}^T\boldsymbol{\beta} + u_j\]</span></p>
<p><span class="math display">\[Y_{ij} \sim NB(\mu_{ij}, \theta)\]</span></p>
<p>where <span class="math inline">\(\mu_{ij}\)</span> is the expected LOS for patient <span class="math inline">\(i\)</span> in year <span class="math inline">\(j\)</span>, <span class="math inline">\(\theta\)</span> is the dispersion parameter, and <span class="math inline">\(u_j\)</span> represents the random year effect. The negative binomial distribution was parameterized using the NB2 specification where variance equals <span class="math inline">\(\mu + \mu^2/\theta\)</span>.</p>
</section>
<section id="model-performance-assessment" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="model-performance-assessment"><span class="header-section-number">4.4.5</span> Model Performance Assessment</h3>
<p>Model discrimination was evaluated using the area under the receiver operating characteristic curve (AUC)<span class="citation" data-cites="hanley1982"><sup><a href="#ref-hanley1982" role="doc-biblioref">47</a></sup></span>:</p>
<p><span class="math display">\[AUC = P(S_1 &gt; S_0)\]</span></p>
<p>where <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_0\)</span> are the predicted probabilities for positive and negative cases, respectively.</p>
<p>Model calibration was assessed using the Hosmer-Lemeshow goodness-of-fit test<span class="citation" data-cites="hosmer2013"><sup><a href="#ref-hosmer2013" role="doc-biblioref">48</a></sup></span>, which compares observed and expected event rates across risk deciles:</p>
<p><span class="math display">\[C = \sum_{g=1}^{10} \frac{(O_g - E_g)^2}{E_g(1 - E_g/n_g)}\]</span></p>
<p>where <span class="math inline">\(O_g\)</span> and <span class="math inline">\(E_g\)</span> are observed and expected events in group <span class="math inline">\(g\)</span>, and <span class="math inline">\(n_g\)</span> is the group size.</p>
</section>
<section id="measures-of-explained-variation" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="measures-of-explained-variation"><span class="header-section-number">4.4.6</span> Measures of Explained Variation</h3>
<p>Three pseudo-R² measures were calculated<span class="citation" data-cites="nagelkerke1991"><sup><a href="#ref-nagelkerke1991" role="doc-biblioref">49</a></sup></span>:</p>
<ol type="1">
<li><p>McFadden’s R²: <span class="math display">\[R^2_{McF} = 1 - \frac{\ln L_{full}}{\ln L_{null}}\]</span></p></li>
<li><p>Cox-Snell R²: <span class="math display">\[R^2_{CS} = 1 - \exp\left(\frac{2(\ln L_{null} - \ln L_{full})}{n}\right)\]</span></p></li>
<li><p>Nagelkerke’s R²: <span class="math display">\[R^2_{N} = \frac{R^2_{CS}}{1 - \exp(2\ln L_{null}/n)}\]</span></p></li>
</ol>
<p>where <span class="math inline">\(L_{full}\)</span> and <span class="math inline">\(L_{null}\)</span> are the likelihoods of the full and null models, respectively.</p>
</section>
<section id="additional-performance-metrics" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="additional-performance-metrics"><span class="header-section-number">4.4.7</span> Additional Performance Metrics</h3>
<p>Model performance was further evaluated using:</p>
<ul>
<li>Sensitivity (true positive rate): <span class="math inline">\(Se = TP/(TP + FN)\)</span></li>
<li>Specificity (true negative rate): <span class="math inline">\(Sp = TN/(TN + FP)\)</span></li>
<li>Positive predictive value: <span class="math inline">\(PPV = TP/(TP + FP)\)</span></li>
<li>Negative predictive value: <span class="math inline">\(NPV = TN/(TN + FN)\)</span></li>
<li>F1 score: <span class="math inline">\(F1 = 2 \cdot (PPV \cdot Se)/(PPV + Se)\)</span></li>
<li>Matthews correlation coefficient<span class="citation" data-cites="matthews1975"><sup><a href="#ref-matthews1975" role="doc-biblioref">50</a></sup></span>:</li>
</ul>
<p><span class="math display">\[MCC = \frac{TP \cdot TN - FP \cdot FN}{\sqrt{(TP + FP)(TP + FN)(TN + FP)(TN + FN)}}\]</span></p>
<ul>
<li>Brier score for probabilistic predictions<span class="citation" data-cites="brier1950"><sup><a href="#ref-brier1950" role="doc-biblioref">51</a></sup></span>:</li>
</ul>
<p><span class="math display">\[BS = \frac{1}{n}\sum_{i=1}^{n}(p_i - o_i)^2\]</span></p>
<p>where <span class="math inline">\(p_i\)</span> is the predicted probability and <span class="math inline">\(o_i\)</span> is the observed outcome.</p>
<p>For negative binomial models, performance was assessed using root mean square error (RMSE) and mean absolute error (MAE):</p>
<p><span class="math display">\[RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}\]</span></p>
<p><span class="math display">\[MAE = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|\]</span></p>
</section>
</section>
<section id="sensitivity-analyses" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sensitivity-analyses"><span class="header-section-number">4.5</span> Sensitivity Analyses</h2>
<p>Models were stratified by cancer site to account for disease-specific heterogeneity. Optimal probability thresholds for binary classification were determined using Youden’s index<span class="citation" data-cites="youden1950"><sup><a href="#ref-youden1950" role="doc-biblioref">52</a></sup></span>:</p>
<p><span class="math display">\[J = \max(Se + Sp - 1)\]</span></p>
<p>All statistical tests were two-sided with significance level set at <span class="math inline">\(\alpha = 0.05\)</span>. Multiple testing adjustment was not applied due to the exploratory nature of the analysis<span class="citation" data-cites="rothman1990"><sup><a href="#ref-rothman1990" role="doc-biblioref">53</a></sup></span>.</p>
</section>
</section>
<section id="results" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Results</h1>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load/Install packages</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>use_packages <span class="ot">&lt;-</span> <span class="cf">function</span>(pkgs){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  new_pkgs <span class="ot">&lt;-</span> pkgs[<span class="sc">!</span>(pkgs <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[,<span class="st">"Package"</span>])]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(new_pkgs)) <span class="fu">install.packages</span>(new_pkgs, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="fu">lapply</span>(pkgs, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista completa de paquetes necesarios desde el inicio</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTANTE: MASS se carga antes de tidyverse para evitar conflictos con select()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">use_packages</span>(<span class="fu">c</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MASS"</span>,           <span class="co"># Statistical functions (loaded first to avoid conflicts)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>,      <span class="co"># Data manipulation and ggplot2 (loaded after MASS)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readxl"</span>,         <span class="co"># Read Excel files</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"knitr"</span>,          <span class="co"># Report generation</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>,     <span class="co"># Table formatting</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lubridate"</span>,      <span class="co"># Date handling</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"htmltools"</span>,      <span class="co"># HTML tools</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"viridis"</span>,        <span class="co"># Color palettes</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"reshape2"</span>,       <span class="co"># Data reshaping</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"glmmTMB"</span>,        <span class="co"># Mixed models</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lme4"</span>,           <span class="co"># Linear mixed effects</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pROC"</span>,           <span class="co"># ROC curves</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"caret"</span>,          <span class="co"># Machine learning</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ResourceSelection"</span>, <span class="co"># Hosmer-Lemeshow test</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"car"</span>,            <span class="co"># Regression diagnostics</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"patchwork"</span>       <span class="co"># Combine plots</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="st">"VROOM_CONNECTION_SIZE"</span> <span class="ot">=</span> <span class="dv">10000000000</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>base_path <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"/docs"</span>, <span class="st">""</span>, <span class="fu">getwd</span>())</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Define output directory and file</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(base_path, <span class="st">"output_files"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>output_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_dir, <span class="st">"data_cancer_processed.rds"</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directory if it doesn't exist</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_dir)) {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(output_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if processed data already exists</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(output_file)) {</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load existing data</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  data_cancer <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(output_file)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create new database</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load and prepare data from 2019-2023</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  years <span class="ot">&lt;-</span> <span class="dv">2019</span><span class="sc">:</span><span class="dv">2023</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  all_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (year <span class="cf">in</span> years) {</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    file_pattern <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"GRD_PUBLICO_.*"</span>, year, <span class="st">".*</span><span class="sc">\\</span><span class="st">.csv$"</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    file_path <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(base_path, <span class="st">"data"</span>),</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">pattern =</span> file_pattern,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(file_path) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>      year_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        file_path, <span class="at">delim =</span> <span class="st">"|"</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="fu">col_character</span>(),</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                         <span class="at">IR_29301_COD_GRD =</span> <span class="fu">col_number</span>()),</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">trim_ws =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">progress =</span> <span class="cn">FALSE</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>      year_data<span class="sc">$</span>year <span class="ot">&lt;-</span> year</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>      all_data[[<span class="fu">as.character</span>(year)]] <span class="ot">&lt;-</span> year_data</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine all years into single dataframe</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  data_all_years <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_data)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up memory</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(all_data)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load catalogs</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  codigos_grd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(base_path, <span class="st">"data/códigos grd.xlsx"</span>), <span class="at">sheet =</span> <span class="st">"IR - GRD"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">colnames&lt;-</span><span class="st">`</span>(<span class="fu">c</span>(<span class="st">"IR_29301_COD_GRD"</span>, <span class="st">"COD_GRD_CAT"</span>))</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  codigos_hosp <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(base_path, <span class="st">"data/códigos grd.xlsx"</span>), <span class="at">sheet =</span> <span class="st">"Hospitales"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">colnames&lt;-</span><span class="st">`</span>(<span class="fu">c</span>(<span class="st">"COD_HOSPITAL"</span>, <span class="st">"COD_HOSPITAL_CAT"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">COD_HOSPITAL =</span> <span class="fu">as.character</span>(COD_HOSPITAL))</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  codigos_pab <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(base_path, <span class="st">"data/códigos grd.xlsx"</span>), <span class="at">sheet =</span> <span class="st">"Tipo de Pabellon"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">colnames&lt;-</span><span class="st">`</span>(<span class="fu">c</span>(<span class="st">"USOSPABELLON"</span>, <span class="st">"COD_PABELLON_CAT"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">USOSPABELLON =</span> <span class="fu">as.character</span>(USOSPABELLON))</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join catalogs</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  data_all_years <span class="ot">&lt;-</span> data_all_years <span class="sc">|&gt;</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(codigos_grd,  <span class="at">by =</span> <span class="st">"IR_29301_COD_GRD"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(codigos_hosp, <span class="at">by =</span> <span class="st">"COD_HOSPITAL"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(codigos_pab,  <span class="at">by =</span> <span class="st">"USOSPABELLON"</span>)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up catalogs</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(codigos_grd, codigos_hosp, codigos_pab)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter patients with target cancers</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  icd_target_primary <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C16"</span>,<span class="st">"C18"</span>,<span class="st">"C19"</span>,<span class="st">"C20"</span>,<span class="st">"C23"</span>,<span class="st">"C25"</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  all_diag_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"DIAGNOSTICO"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  all_diag_cols <span class="ot">&lt;-</span> <span class="fu">intersect</span>(all_diag_cols, <span class="fu">names</span>(data_all_years))</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalize diagnostic fields</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> all_diag_cols){</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    data_all_years[[<span class="fu">paste0</span>(col, <span class="st">"_NORM"</span>)]] <span class="ot">&lt;-</span> <span class="fu">str_to_upper</span>(<span class="fu">str_trim</span>(data_all_years[[col]]))</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter function</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  has_target_cancer <span class="ot">&lt;-</span> <span class="cf">function</span>(row){</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    diag_values <span class="ot">&lt;-</span> <span class="fu">unlist</span>(row)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    diag_values <span class="ot">&lt;-</span> diag_values[<span class="sc">!</span><span class="fu">is.na</span>(diag_values) <span class="sc">&amp;</span> diag_values <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">any</span>(<span class="fu">str_detect</span>(diag_values, <span class="fu">paste0</span>(<span class="st">"^("</span>, <span class="fu">paste</span>(icd_target_primary, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="st">")"</span>)))</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply filter</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  norm_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(all_diag_cols, <span class="st">"_NORM"</span>)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  data_norm_subset <span class="ot">&lt;-</span> data_all_years[, norm_cols]</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  has_cancer_vector <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_norm_subset, <span class="dv">1</span>, has_target_cancer)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  data_cancer <span class="ot">&lt;-</span> data_all_years[has_cancer_vector, ] <span class="sc">|&gt;</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">"_NORM"</span>))</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up large intermediate objects</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(data_all_years, data_norm_subset, has_cancer_vector, norm_cols)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate age and classify cancer site based on ALL diagnostic fields</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to determine cancer site from all diagnoses</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  determine_cancer_site <span class="ot">&lt;-</span> <span class="cf">function</span>(row) {</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    diag_fields <span class="ot">&lt;-</span> row[<span class="fu">grep</span>(<span class="st">"^DIAGNOSTICO[0-9]+$"</span>, <span class="fu">names</span>(row))]</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (diag <span class="cf">in</span> diag_fields) {</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(diag) <span class="sc">&amp;&amp;</span> diag <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        diag_upper <span class="ot">&lt;-</span> <span class="fu">str_to_upper</span>(<span class="fu">str_trim</span>(diag))</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">str_starts</span>(diag_upper, <span class="st">"C16"</span>)) <span class="fu">return</span>(<span class="st">"Stomach"</span>)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">str_starts</span>(diag_upper, <span class="st">"C18"</span>) <span class="sc">|</span> <span class="fu">str_starts</span>(diag_upper, <span class="st">"C19"</span>) <span class="sc">|</span> <span class="fu">str_starts</span>(diag_upper, <span class="st">"C20"</span>)) <span class="fu">return</span>(<span class="st">"Colorectal"</span>)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">str_starts</span>(diag_upper, <span class="st">"C25"</span>)) <span class="fu">return</span>(<span class="st">"Pancreas"</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">str_starts</span>(diag_upper, <span class="st">"C23"</span>)) <span class="fu">return</span>(<span class="st">"Gallbladder"</span>)</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Other/Secondary"</span>)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine which diagnostic position contains the cancer</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  determine_cancer_position <span class="ot">&lt;-</span> <span class="cf">function</span>(row) {</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>) {</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>      field_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"DIAGNOSTICO"</span>, i)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (field_name <span class="sc">%in%</span> <span class="fu">names</span>(row)) {</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>        diag <span class="ot">&lt;-</span> row[[field_name]]</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(diag) <span class="sc">&amp;&amp;</span> diag <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>          diag_upper <span class="ot">&lt;-</span> <span class="fu">str_to_upper</span>(<span class="fu">str_trim</span>(diag))</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">str_starts</span>(diag_upper, <span class="st">"C16"</span>) <span class="sc">|</span> </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str_starts</span>(diag_upper, <span class="st">"C18"</span>) <span class="sc">|</span> </span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str_starts</span>(diag_upper, <span class="st">"C19"</span>) <span class="sc">|</span> </span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str_starts</span>(diag_upper, <span class="st">"C20"</span>) <span class="sc">|</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str_starts</span>(diag_upper, <span class="st">"C23"</span>) <span class="sc">|</span> </span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str_starts</span>(diag_upper, <span class="st">"C25"</span>)) {</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(i)</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>  data_cancer <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>      <span class="at">cancer_site =</span> <span class="fu">apply</span>(data_cancer, <span class="dv">1</span>, determine_cancer_site),</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>      <span class="at">diagnostic_position =</span> <span class="fu">apply</span>(data_cancer, <span class="dv">1</span>, determine_cancer_position),</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Handle different date formats by year</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Birth date always in DD-MM-YYYY format</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>      <span class="at">FECHA_NACIMIENTO =</span> <span class="fu">as.Date</span>(FECHA_NACIMIENTO, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>),</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Admission and discharge dates: YYYY-MM-DD for 2019-2022, DD-MM-YYYY for 2023</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">FECHA_INGRESO =</span> <span class="fu">if_else</span>(</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">==</span> <span class="dv">2023</span>,</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.Date</span>(FECHA_INGRESO, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>),</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.Date</span>(FECHA_INGRESO, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>      <span class="at">FECHAALTA =</span> <span class="fu">if_else</span>(</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">==</span> <span class="dv">2023</span>,</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.Date</span>(FECHAALTA, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>),</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.Date</span>(FECHAALTA, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>      <span class="at">EDAD =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(FECHA_INGRESO, FECHA_NACIMIENTO, <span class="at">units =</span> <span class="st">"days"</span>)) <span class="sc">/</span> <span class="fl">365.25</span>, <span class="dv">0</span>),</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>      <span class="at">length_of_stay =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(FECHAALTA, FECHA_INGRESO, <span class="at">units =</span> <span class="st">"days"</span>)),</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Factor variables for severity and mortality risk</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>      <span class="at">IR_29301_SEVERIDAD =</span> <span class="fu">factor</span>(IR_29301_SEVERIDAD, </span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>), </span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>)),</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>      <span class="at">IR_29301_MORTALIDAD =</span> <span class="fu">factor</span>(IR_29301_MORTALIDAD, </span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>), </span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low risk"</span>, <span class="st">"Medium risk"</span>, <span class="st">"High risk"</span>)),</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Classify admission services</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>      <span class="at">service_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(SERVICIOINGRESO, <span class="st">"UNIDAD DE CUIDADOS INTENSIVOS|CUIDADOS"</span>) <span class="sc">~</span> <span class="st">"ICU"</span>,</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(SERVICIOINGRESO, <span class="st">"UNIDAD DE TRATAMIENTO INTERMEDIO|UTI"</span>) <span class="sc">~</span> <span class="st">"ITU"</span>,</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(SERVICIOINGRESO, <span class="st">"AGUDOS|CIRUGÍA|RECUPERACIÓN|MEDICO-QUIRURGICO|MÉDICO QUIRÚRGICO|MQ PEDIATRIA|MEDICO QUIRÚRGICOS"</span>) <span class="sc">~</span> <span class="st">"MS"</span>,</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Others"</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Set Others as reference category</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>      <span class="at">service_category =</span> <span class="fu">factor</span>(service_category, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Others"</span>, <span class="st">"ICU"</span>, <span class="st">"ITU"</span>, <span class="st">"MS"</span>))</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cancer_site <span class="sc">!=</span> <span class="st">"Other/Secondary"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEXO <span class="sc">!=</span> <span class="st">"DESCONOCIDO"</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define comorbidity groups</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>  icd3_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_to_upper</span>(stringr<span class="sc">::</span><span class="fu">str_trim</span>(x))</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(x, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>)</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_sub</span>(x, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>  life_groups <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">obesity_overweight =</span> <span class="fu">c</span>(<span class="st">"E66"</span>, <span class="st">"E65"</span>, <span class="st">"E67"</span>, <span class="st">"E68"</span>, <span class="st">"R63"</span>, <span class="st">"Z68"</span>),</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>    <span class="at">dyslipidemia_metabolic =</span> <span class="fu">c</span>(<span class="st">"E78"</span>, <span class="st">"E79"</span>, <span class="st">"E88"</span>),</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes_glucose =</span> <span class="fu">c</span>(<span class="st">"E10"</span>, <span class="st">"E11"</span>, <span class="st">"E12"</span>, <span class="st">"E13"</span>, <span class="st">"E14"</span>, <span class="st">"E09"</span>, <span class="st">"R73"</span>, <span class="st">"E08"</span>),</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">hypertension =</span> <span class="fu">c</span>(<span class="st">"I10"</span>, <span class="st">"I11"</span>, <span class="st">"I12"</span>, <span class="st">"I13"</span>, <span class="st">"I15"</span>, <span class="st">"I16"</span>, <span class="st">"I27"</span>),</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">tobacco_related =</span> <span class="fu">c</span>(<span class="st">"F17"</span>, <span class="st">"Z72"</span>, <span class="st">"Z87"</span>, <span class="st">"J44"</span>, <span class="st">"J43"</span>, <span class="st">"J41"</span>, <span class="st">"J42"</span>, <span class="st">"J47"</span>, <span class="st">"J40"</span>, <span class="st">"J98"</span>),</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">alcohol_related =</span> <span class="fu">c</span>(<span class="st">"F10"</span>, <span class="st">"K70"</span>, <span class="st">"K29"</span>, <span class="st">"G31"</span>, <span class="st">"G62"</span>, <span class="st">"G72"</span>, <span class="st">"I42"</span>, <span class="st">"K86"</span>, <span class="st">"E24"</span>, <span class="st">"E52"</span>, <span class="st">"T51"</span>, <span class="st">"Y90"</span>, <span class="st">"Y91"</span>),</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">substance_use =</span> <span class="fu">c</span>(<span class="st">"F11"</span>, <span class="st">"F12"</span>, <span class="st">"F13"</span>, <span class="st">"F14"</span>, <span class="st">"F15"</span>, <span class="st">"F16"</span>, <span class="st">"F18"</span>, <span class="st">"F19"</span>, <span class="st">"F55"</span>),</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">nutritional_problems =</span> <span class="fu">c</span>(<span class="st">"E40"</span>, <span class="st">"E41"</span>, <span class="st">"E42"</span>, <span class="st">"E43"</span>, <span class="st">"E44"</span>, <span class="st">"E45"</span>, <span class="st">"E46"</span>, <span class="st">"E50"</span>, <span class="st">"E51"</span>, <span class="st">"E52"</span>, <span class="st">"E53"</span>, </span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"E54"</span>, <span class="st">"E55"</span>, <span class="st">"E56"</span>, <span class="st">"E58"</span>, <span class="st">"E59"</span>, <span class="st">"E60"</span>, <span class="st">"E61"</span>, <span class="st">"E63"</span>, <span class="st">"E64"</span>, </span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"D50"</span>, <span class="st">"D51"</span>, <span class="st">"D52"</span>, <span class="st">"D53"</span>),</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">liver_disease_nonalcoholic =</span> <span class="fu">c</span>(<span class="st">"K76"</span>, <span class="st">"K72"</span>, <span class="st">"K73"</span>, <span class="st">"K74"</span>, <span class="st">"K75"</span>, <span class="st">"K77"</span>),</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">sleep_disorders =</span> <span class="fu">c</span>(<span class="st">"G47"</span>, <span class="st">"F51"</span>, <span class="st">"G25"</span>),</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">cardiovascular_lifestyle =</span> <span class="fu">c</span>(<span class="st">"I20"</span>, <span class="st">"I21"</span>, <span class="st">"I22"</span>, <span class="st">"I23"</span>, <span class="st">"I24"</span>, <span class="st">"I25"</span>, <span class="st">"I50"</span>, <span class="st">"I51"</span>, </span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"I64"</span>, <span class="st">"I65"</span>, <span class="st">"I66"</span>, <span class="st">"I67"</span>, <span class="st">"I70"</span>, <span class="st">"I73"</span>, <span class="st">"I77"</span>, <span class="st">"I78"</span>),</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">gastrointestinal_lifestyle =</span> <span class="fu">c</span>(<span class="st">"K21"</span>, <span class="st">"K22"</span>, <span class="st">"K25"</span>, <span class="st">"K26"</span>, <span class="st">"K27"</span>, <span class="st">"K28"</span>, <span class="st">"K29"</span>, <span class="st">"K30"</span>, </span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"K31"</span>, <span class="st">"K58"</span>, <span class="st">"K59"</span>, <span class="st">"K90"</span>, <span class="st">"K91"</span>, <span class="st">"K92"</span>),</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">musculoskeletal_sedentary =</span> <span class="fu">c</span>(<span class="st">"M79"</span>, <span class="st">"M81"</span>, <span class="st">"M80"</span>, <span class="st">"M85"</span>, <span class="st">"M62"</span>, <span class="st">"M25"</span>, <span class="st">"M54"</span>),</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">mental_health_lifestyle =</span> <span class="fu">c</span>(<span class="st">"F32"</span>, <span class="st">"F33"</span>, <span class="st">"F34"</span>, <span class="st">"F41"</span>, <span class="st">"F43"</span>, <span class="st">"F48"</span>, <span class="st">"F50"</span>, <span class="st">"F54"</span>)</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create normalized ICD-10 columns</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>  comorb_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"DIAGNOSTICO"</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">35</span>)</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>  comorb_cols <span class="ot">&lt;-</span> <span class="fu">intersect</span>(comorb_cols, <span class="fu">names</span>(data_cancer))</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> comorb_cols){</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    data_cancer[[<span class="fu">paste0</span>(col, <span class="st">"_C3"</span>)]] <span class="ot">&lt;-</span> <span class="fu">icd3_norm</span>(data_cancer[[col]])</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create comorbidity dummy variables</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>  c3_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(comorb_cols, <span class="st">"_C3"</span>)</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>  has_comorbidity <span class="ot">&lt;-</span> <span class="cf">function</span>(row_codes, target_codes){</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">any</span>(row_codes <span class="sc">%in%</span> target_codes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(group_name <span class="cf">in</span> <span class="fu">names</span>(life_groups)){</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>    target_codes <span class="ot">&lt;-</span> life_groups[[group_name]]</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>    data_cancer[[group_name]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>      data_cancer[, c3_cols], </span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, </span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) <span class="fu">as.integer</span>(<span class="fu">has_comorbidity</span>(x, target_codes))</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summary variables</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>  dummy_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(life_groups)</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>  data_cancer<span class="sc">$</span>n_lifestyle_comorb <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(data_cancer[, dummy_vars], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up intermediate columns</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>  data_cancer <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">"_C3"</span>))</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add estado_alta variable</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>  data_cancer <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>      <span class="at">estado_alta =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>        TIPOALTA <span class="sc">==</span> <span class="st">"FALLECIDO"</span> <span class="sc">~</span> <span class="st">"Deceased"</span>,</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>        TIPOALTA <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DOMICILIO"</span>, <span class="st">"ALTA VOLUNTARIA"</span>, <span class="st">"HOSPITALIZACIÓN DOMICILIARIA"</span>,</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"DERIVACIÓN OTRO HOSPITAL DEL SERVICIO"</span>, </span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"DERIVACIÓN OTRO HOSPITAL DE LA RED NACIONAL"</span>,</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"DERIVACIÓN INST. PRIVADA (COMPRA DE SERVICIOS"</span>,</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"DERIVACIÓN INST. PRIVADA (VOLUNTARIO)"</span>,</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"DERIVACIÓN A OTROS CENTROS (CÁRCEL, HOGAR DE"</span>) <span class="sc">~</span> <span class="st">"Discharged"</span>,</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>  data_cancer<span class="sc">$</span>service_category <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_cancer<span class="sc">$</span>service_category, </span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Others"</span>, <span class="st">"ICU"</span>, <span class="st">"ITU"</span>, <span class="st">"MS"</span>))</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save processed data</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ==========================</span></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(data_cancer, output_file)</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create comorbidity prevalence table</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>create_comorbidity_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">group_var =</span> <span class="st">"cancer_site"</span>) {</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span><span class="fu">sym</span>(group_var)) <span class="sc">|&gt;</span></span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Obesity and Overweight</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(obesity_overweight) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Dyslipidemia and Metabolic Disorders</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(dyslipidemia_metabolic) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Diabetes and Glucose Disorders</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(diabetes_glucose) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Hypertension</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(hypertension) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Tobacco Related Diseases</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(tobacco_related) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Alcohol Related Diseases</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(alcohol_related) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Other Substance Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(substance_use) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Nutritional Deficiencies</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(nutritional_problems) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Non Alcoholic Liver Disease</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(liver_disease_nonalcoholic) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Sleep Disorders</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(sleep_disorders) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Cardiovascular Diseases</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(cardiovascular_lifestyle) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Gastrointestinal Problems</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(gastrointestinal_lifestyle) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Musculoskeletal Disorders</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(musculoskeletal_sedentary) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Mental Health Problems</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(mental_health_lifestyle) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Any Lifestyle Comorbidity (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Mean Number of Comorbidities</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb), <span class="dv">2</span>),</span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(N))</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create heatmap</span></span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>create_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(table_data, title, <span class="at">subtitle =</span> <span class="cn">NULL</span>, <span class="at">viridis_option =</span> <span class="st">"D"</span>) {</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>  heatmap_data <span class="ot">&lt;-</span> table_data <span class="sc">|&gt;</span></span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Patients"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Comorbidity"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Number"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"Cancer Site"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>  heatmap_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(heatmap_data)</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(heatmap_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cancer Site"</span>, <span class="st">"Comorbidity"</span>, <span class="st">"Prevalence"</span>)</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(heatmap_long, <span class="fu">aes</span>(<span class="at">x =</span> Comorbidity, <span class="at">y =</span> <span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span>, <span class="at">fill =</span> Prevalence)) <span class="sc">+</span></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">name =</span> <span class="st">"Prevalence (%)"</span>, </span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> viridis_option,</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(heatmap_long<span class="sc">$</span>Prevalence))) <span class="sc">+</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title, <span class="at">subtitle =</span> subtitle, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, Prevalence)), </span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a><span class="co"># P-VALUE CALCULATIONS</span></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate p-values for mortality differences</span></span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>calculate_mortality_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>  cancer_sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(data<span class="sc">$</span>cancer_site)</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>  comorbidities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"obesity_overweight"</span>, <span class="st">"dyslipidemia_metabolic"</span>, <span class="st">"diabetes_glucose"</span>,</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"hypertension"</span>, <span class="st">"tobacco_related"</span>, <span class="st">"alcohol_related"</span>,</span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"substance_use"</span>, <span class="st">"nutritional_problems"</span>, <span class="st">"liver_disease_nonalcoholic"</span>,</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"sleep_disorders"</span>, <span class="st">"cardiovascular_lifestyle"</span>, <span class="st">"gastrointestinal_lifestyle"</span>,</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"musculoskeletal_sedentary"</span>, <span class="st">"mental_health_lifestyle"</span>)</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>  p_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(cancer_sites), <span class="at">ncol =</span> <span class="fu">length</span>(comorbidities))</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(p_matrix) <span class="ot">&lt;-</span> cancer_sites</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(p_matrix) <span class="ot">&lt;-</span> comorbidities</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cancer_sites)) {</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(comorbidities)) {</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>      subset_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>cancer_site <span class="sc">==</span> cancer_sites[i], ]</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>      mortality_table <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>        subset_data[[comorbidities[j]]],</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>        subset_data<span class="sc">$</span>estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">min</span>(mortality_table) <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">||</span> <span class="fu">sum</span>(mortality_table) <span class="sc">&lt;</span> <span class="dv">100</span>) {</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>        test_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">fisher.test</span>(mortality_table))</span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>        test_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(mortality_table))</span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>      p_matrix[i, j] <span class="ot">&lt;-</span> test_result<span class="sc">$</span>p.value</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p_matrix)</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate p-values for LOS differences</span></span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>calculate_los_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>  cancer_sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(data<span class="sc">$</span>cancer_site)</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>  comorbidities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"obesity_overweight"</span>, <span class="st">"dyslipidemia_metabolic"</span>, <span class="st">"diabetes_glucose"</span>,</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"hypertension"</span>, <span class="st">"tobacco_related"</span>, <span class="st">"alcohol_related"</span>,</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"substance_use"</span>, <span class="st">"nutritional_problems"</span>, <span class="st">"liver_disease_nonalcoholic"</span>,</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"sleep_disorders"</span>, <span class="st">"cardiovascular_lifestyle"</span>, <span class="st">"gastrointestinal_lifestyle"</span>,</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"musculoskeletal_sedentary"</span>, <span class="st">"mental_health_lifestyle"</span>)</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>  p_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(cancer_sites), <span class="at">ncol =</span> <span class="fu">length</span>(comorbidities))</span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(p_matrix) <span class="ot">&lt;-</span> cancer_sites</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(p_matrix) <span class="ot">&lt;-</span> comorbidities</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cancer_sites)) {</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(comorbidities)) {</span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>      subset_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>cancer_site <span class="sc">==</span> cancer_sites[i], ]</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>      los_with <span class="ot">&lt;-</span> subset_data<span class="sc">$</span>length_of_stay[subset_data[[comorbidities[j]]] <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>      los_without <span class="ot">&lt;-</span> subset_data<span class="sc">$</span>length_of_stay[subset_data[[comorbidities[j]]] <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(los_with) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">||</span> <span class="fu">length</span>(los_without) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>        p_matrix[i, j] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>      test_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">wilcox.test</span>(los_with, los_without))</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>      p_matrix[i, j] <span class="ot">&lt;-</span> test_result<span class="sc">$</span>p.value</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p_matrix)</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a><span class="co"># Create all tables</span></span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 0: Diagnostic position analysis</span></span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>diagnostic_position_table <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">position_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>    diagnostic_position <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Primary Diagnosis"</span>,</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>    diagnostic_position <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Secondary Diagnoses (2-5)"</span>,</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>    diagnostic_position <span class="sc">%in%</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">~</span> <span class="st">"Later Diagnoses (6-10)"</span>,</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Very Late Diagnoses (11+)"</span></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(position_group) <span class="sc">|&gt;</span></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Cases</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Percentage</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(data_cancer) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Female (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(SEXO <span class="sc">==</span> <span class="st">"MUJER"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mortality Rate (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Any Comorbidity (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Comorbidities</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb), <span class="dv">2</span>)</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 1: Patient Distribution</span></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>tabla_distribucion <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cancer_site) <span class="sc">|&gt;</span></span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Patients</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Discharged Alive</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(estado_alta <span class="sc">==</span> <span class="st">"Discharged"</span>),</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Deceased</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>),</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other Status</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(estado_alta <span class="sc">==</span> <span class="st">"Other"</span>),</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mortality Rate (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>) <span class="sc">/</span> <span class="fu">n</span>() <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Age (years)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Age Range</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">min</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"-"</span>, <span class="fu">max</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Female (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(SEXO <span class="sc">==</span> <span class="st">"MUJER"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean LOS (days)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median LOS (days)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">median</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">LOS Range</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">min</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"-"</span>, <span class="fu">max</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>)</span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Total Patients</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site)</span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2: Trends by Year</span></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>tabla_year <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, cancer_site) <span class="sc">|&gt;</span></span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Patients</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mortality Rate (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>) <span class="sc">/</span> <span class="fu">n</span>() <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Any Comorbidity (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="ot">=</span> year, <span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site)</span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a><span class="co"># Tables 3-5: Comorbidity tables</span></span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a>tabla_total <span class="ot">&lt;-</span> <span class="fu">create_comorbidity_table</span>(data_cancer) <span class="sc">|&gt;</span></span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site, <span class="st">`</span><span class="at">Total Patients</span><span class="st">`</span> <span class="ot">=</span> N)</span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a>tabla_alta <span class="ot">&lt;-</span> <span class="fu">create_comorbidity_table</span>(</span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_cancer, estado_alta <span class="sc">==</span> <span class="st">"Discharged"</span>)</span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site, <span class="st">`</span><span class="at">Discharged Patients</span><span class="st">`</span> <span class="ot">=</span> N)</span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a>tabla_fallecidos <span class="ot">&lt;-</span> <span class="fu">create_comorbidity_table</span>(</span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_cancer, estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>)</span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site, <span class="st">`</span><span class="at">Deceased Patients</span><span class="st">`</span> <span class="ot">=</span> N)</span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 6: Summary by discharge status</span></span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estado_alta <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Discharged"</span>, <span class="st">"Deceased"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Discharge Status</span><span class="st">`</span> <span class="ot">=</span> estado_alta) <span class="sc">|&gt;</span></span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Patients</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Female (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(SEXO <span class="sc">==</span> <span class="st">"MUJER"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean LOS (days)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median LOS (days)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">median</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Any Lifestyle Comorbidity (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Comorbidities</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb), <span class="dv">2</span>),</span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Patients with 3+ Comorbidities (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 7: LOS analysis</span></span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a>los_analysis <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estado_alta <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Discharged"</span>, <span class="st">"Deceased"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site, <span class="st">`</span><span class="at">Discharge Status</span><span class="st">`</span> <span class="ot">=</span> estado_alta) <span class="sc">|&gt;</span></span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">N</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">median</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">IQR</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(length_of_stay, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">0</span>), </span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"-"</span>, </span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">quantile</span>(length_of_stay, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">0</span>)),</span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 8: Yearly trends</span></span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a>yearly_trends <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Cases</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Stomach</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(cancer_site <span class="sc">==</span> <span class="st">"Stomach"</span>),</span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Colorectal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(cancer_site <span class="sc">==</span> <span class="st">"Colorectal"</span>),</span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Pancreas</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(cancer_site <span class="sc">==</span> <span class="st">"Pancreas"</span>),</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Gallbladder</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(cancer_site <span class="sc">==</span> <span class="st">"Gallbladder"</span>),</span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mortality Rate (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(EDAD, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean LOS</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Any Comorbidity (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(n_lifestyle_comorb <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="ot">=</span> year)</span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 9: Mean LOS by cancer site and comorbidities</span></span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a>los_comorbidity_table <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cancer_site) <span class="sc">|&gt;</span></span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Obesity and Overweight</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[obesity_overweight <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dyslipidemia and Metabolic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[dyslipidemia_metabolic <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Diabetes and Glucose</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[diabetes_glucose <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Hypertension</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[hypertension <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Tobacco Related</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[tobacco_related <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Alcohol Related</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[alcohol_related <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other Substance Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[substance_use <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Nutritional Deficiencies</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[nutritional_problems <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Non Alcoholic Liver</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[liver_disease_nonalcoholic <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sleep Disorders</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[sleep_disorders <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cardiovascular</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[cardiovascular_lifestyle <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Gastrointestinal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[gastrointestinal_lifestyle <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Musculoskeletal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[musculoskeletal_sedentary <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mental Health</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[mental_health_lifestyle <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site)</span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 10: LOS difference table</span></span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>los_diff_table <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cancer_site) <span class="sc">|&gt;</span></span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Obesity</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[obesity_overweight <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mean</span>(length_of_stay[obesity_overweight <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dyslipidemia</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[dyslipidemia_metabolic <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mean</span>(length_of_stay[dyslipidemia_metabolic <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Diabetes</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[diabetes_glucose <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mean</span>(length_of_stay[diabetes_glucose <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Hypertension</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[hypertension <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mean</span>(length_of_stay[hypertension <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Tobacco</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[tobacco_related <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mean</span>(length_of_stay[tobacco_related <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Alcohol</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[alcohol_related <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mean</span>(length_of_stay[alcohol_related <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Substance Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[substance_use <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">mean</span>(length_of_stay[substance_use <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Nutritional</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[nutritional_problems <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">mean</span>(length_of_stay[nutritional_problems <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Liver Disease</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[liver_disease_nonalcoholic <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">mean</span>(length_of_stay[liver_disease_nonalcoholic <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sleep</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[sleep_disorders <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mean</span>(length_of_stay[sleep_disorders <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cardiovascular</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[cardiovascular_lifestyle <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mean</span>(length_of_stay[cardiovascular_lifestyle <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Gastrointestinal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[gastrointestinal_lifestyle <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>(length_of_stay[gastrointestinal_lifestyle <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Musculoskeletal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[musculoskeletal_sedentary <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(length_of_stay[musculoskeletal_sedentary <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mental Health</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(length_of_stay[mental_health_lifestyle <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">mean</span>(length_of_stay[mental_health_lifestyle <span class="sc">==</span> <span class="dv">0</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span> <span class="ot">=</span> cancer_site)</span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate p-values</span></span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>mortality_pvalues <span class="ot">&lt;-</span> <span class="fu">calculate_mortality_pvalues</span>(data_cancer)</span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a>los_pvalues <span class="ot">&lt;-</span> <span class="fu">calculate_los_pvalues</span>(data_cancer)</span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all tables with kable</span></span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 0</span></span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>diagnostic_position_table <span class="sc">|&gt;</span></span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 0: Patient Characteristics by Cancer Diagnostic Position"</span>,</span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(diagnostic_position_table)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#9b59b6"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 0: Patient Characteristics by Cancer Diagnostic Position</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">position_group</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Total Cases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Percentage</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Mean Age</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Female (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Mortality Rate (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Mean LOS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Any Comorbidity (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(155, 89, 182, 255) !important;">Mean Comorbidities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Later Diagnoses (6-10)</td>
<td style="text-align: center;">4260</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">70.2</td>
<td style="text-align: center;">45.0</td>
<td style="text-align: center;">16.5</td>
<td style="text-align: center;">12.6</td>
<td style="text-align: center;">88.3</td>
<td style="text-align: center;">2.15</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Primary Diagnosis</td>
<td style="text-align: center;">49953</td>
<td style="text-align: center;">53.6</td>
<td style="text-align: center;">65.9</td>
<td style="text-align: center;">45.9</td>
<td style="text-align: center;">6.2</td>
<td style="text-align: center;">9.9</td>
<td style="text-align: center;">69.2</td>
<td style="text-align: center;">1.45</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Secondary Diagnoses (2-5)</td>
<td style="text-align: center;">37862</td>
<td style="text-align: center;">40.6</td>
<td style="text-align: center;">64.8</td>
<td style="text-align: center;">45.7</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">5.8</td>
<td style="text-align: center;">61.7</td>
<td style="text-align: center;">1.18</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Very Late Diagnoses (11+)</td>
<td style="text-align: center;">1101</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">70.7</td>
<td style="text-align: center;">44.3</td>
<td style="text-align: center;">26.0</td>
<td style="text-align: center;">23.4</td>
<td style="text-align: center;">94.1</td>
<td style="text-align: center;">2.93</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tabla_distribucion <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 1: Patient Distribution by Cancer Site and Demographics (All Years: 2019-2023)"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(tabla_distribucion)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#2c3e50"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 1: Patient Distribution by Cancer Site and Demographics (All Years: 2019-2023)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Total Patients</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Discharged Alive</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Deceased</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Other Status</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Mortality Rate (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Mean Age (years)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Age Range</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Female (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Mean LOS (days)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Median LOS (days)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">LOS Range</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">SD LOS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">51291</td>
<td style="text-align: center;">48769</td>
<td style="text-align: center;">2482</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">65.1</td>
<td style="text-align: center;">0 - 110</td>
<td style="text-align: center;">48.1</td>
<td style="text-align: center;">8.1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0 - 806</td>
<td style="text-align: center;">12.4</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">26682</td>
<td style="text-align: center;">24813</td>
<td style="text-align: center;">1828</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">6.9</td>
<td style="text-align: center;">66.5</td>
<td style="text-align: center;">0 - 103</td>
<td style="text-align: center;">33.1</td>
<td style="text-align: center;">8.5</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0 - 303</td>
<td style="text-align: center;">13.5</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">8266</td>
<td style="text-align: center;">7357</td>
<td style="text-align: center;">903</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">10.9</td>
<td style="text-align: center;">65.7</td>
<td style="text-align: center;">0 - 102</td>
<td style="text-align: center;">52.8</td>
<td style="text-align: center;">10.1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0 - 374</td>
<td style="text-align: center;">14.4</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">6937</td>
<td style="text-align: center;">6193</td>
<td style="text-align: center;">736</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">66.6</td>
<td style="text-align: center;">0 - 101</td>
<td style="text-align: center;">68.9</td>
<td style="text-align: center;">9.3</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0 - 179</td>
<td style="text-align: center;">11.0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>tabla_year <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 2: Trends by Year and Cancer Site"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(tabla_year)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#8e44ad"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 2: Trends by Year and Cancer Site</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Year</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Total Patients</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Mortality Rate (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Mean Age</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Mean LOS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(142, 68, 173, 255) !important;">Any Comorbidity (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2019</td>
<td style="text-align: center;">Colorectal</td>
<td style="text-align: center;">12609</td>
<td style="text-align: center;">4.0</td>
<td style="text-align: center;">64.6</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">60.1</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2019</td>
<td style="text-align: center;">Gallbladder</td>
<td style="text-align: center;">1581</td>
<td style="text-align: center;">10.5</td>
<td style="text-align: center;">66.1</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">65.9</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2019</td>
<td style="text-align: center;">Pancreas</td>
<td style="text-align: center;">1836</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">65.5</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">66.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2019</td>
<td style="text-align: center;">Stomach</td>
<td style="text-align: center;">6562</td>
<td style="text-align: center;">5.9</td>
<td style="text-align: center;">66.2</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">64.7</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2020</td>
<td style="text-align: center;">Colorectal</td>
<td style="text-align: center;">8197</td>
<td style="text-align: center;">5.5</td>
<td style="text-align: center;">64.7</td>
<td style="text-align: center;">8.3</td>
<td style="text-align: center;">63.5</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2020</td>
<td style="text-align: center;">Gallbladder</td>
<td style="text-align: center;">1246</td>
<td style="text-align: center;">11.6</td>
<td style="text-align: center;">66.4</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">67.3</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2020</td>
<td style="text-align: center;">Pancreas</td>
<td style="text-align: center;">1338</td>
<td style="text-align: center;">11.7</td>
<td style="text-align: center;">65.7</td>
<td style="text-align: center;">10.8</td>
<td style="text-align: center;">73.1</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2020</td>
<td style="text-align: center;">Stomach</td>
<td style="text-align: center;">4478</td>
<td style="text-align: center;">8.3</td>
<td style="text-align: center;">66.1</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">66.1</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2021</td>
<td style="text-align: center;">Colorectal</td>
<td style="text-align: center;">8515</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">65.1</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">65.8</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2021</td>
<td style="text-align: center;">Gallbladder</td>
<td style="text-align: center;">1332</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">66.4</td>
<td style="text-align: center;">9.8</td>
<td style="text-align: center;">72.7</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2021</td>
<td style="text-align: center;">Pancreas</td>
<td style="text-align: center;">1435</td>
<td style="text-align: center;">10.4</td>
<td style="text-align: center;">65.9</td>
<td style="text-align: center;">10.5</td>
<td style="text-align: center;">72.5</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2021</td>
<td style="text-align: center;">Stomach</td>
<td style="text-align: center;">4604</td>
<td style="text-align: center;">7.7</td>
<td style="text-align: center;">66.1</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">68.2</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2022</td>
<td style="text-align: center;">Colorectal</td>
<td style="text-align: center;">9973</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">65.8</td>
<td style="text-align: center;">8.5</td>
<td style="text-align: center;">68.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2022</td>
<td style="text-align: center;">Gallbladder</td>
<td style="text-align: center;">1322</td>
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">66.6</td>
<td style="text-align: center;">10.1</td>
<td style="text-align: center;">73.5</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2022</td>
<td style="text-align: center;">Pancreas</td>
<td style="text-align: center;">1653</td>
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">65.5</td>
<td style="text-align: center;">10.4</td>
<td style="text-align: center;">75.8</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2022</td>
<td style="text-align: center;">Stomach</td>
<td style="text-align: center;">5204</td>
<td style="text-align: center;">7.1</td>
<td style="text-align: center;">67.0</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">73.0</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2023</td>
<td style="text-align: center;">Colorectal</td>
<td style="text-align: center;">11997</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">65.5</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">68.1</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2023</td>
<td style="text-align: center;">Gallbladder</td>
<td style="text-align: center;">1456</td>
<td style="text-align: center;">10.4</td>
<td style="text-align: center;">67.4</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">76.4</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2023</td>
<td style="text-align: center;">Pancreas</td>
<td style="text-align: center;">2004</td>
<td style="text-align: center;">10.9</td>
<td style="text-align: center;">66.1</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">75.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2023</td>
<td style="text-align: center;">Stomach</td>
<td style="text-align: center;">5834</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">67.2</td>
<td style="text-align: center;">8.4</td>
<td style="text-align: center;">73.1</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 3</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tabla_total <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Any Lifestyle Comorbidity (%)</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Mean Number of Comorbidities</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 3: Prevalence (%) of Lifestyle-Related Comorbidities - All Patients (2019-2023)"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(tabla_total)<span class="sc">-</span><span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#34495e"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 3: Prevalence (%) of Lifestyle-Related Comorbidities - All Patients (2019-2023)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Total Patients</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Obesity and Overweight</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Dyslipidemia and Metabolic Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Diabetes and Glucose Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Hypertension</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Tobacco Related Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Alcohol Related Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Other Substance Use</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Nutritional Deficiencies</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Non Alcoholic Liver Disease</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Sleep Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Cardiovascular Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Gastrointestinal Problems</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Musculoskeletal Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Mental Health Problems</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">51291</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">9.4</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">44.4</td>
<td style="text-align: center;">13.4</td>
<td style="text-align: center;">4.5</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">5.8</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">7.8</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">3.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">26682</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">9.6</td>
<td style="text-align: center;">22.7</td>
<td style="text-align: center;">43.7</td>
<td style="text-align: center;">16.3</td>
<td style="text-align: center;">7.2</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">9.2</td>
<td style="text-align: center;">14.8</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">8266</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">9.9</td>
<td style="text-align: center;">36.0</td>
<td style="text-align: center;">47.3</td>
<td style="text-align: center;">15.0</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">6.9</td>
<td style="text-align: center;">6.6</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">7.8</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">3.7</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">6937</td>
<td style="text-align: center;">6.9</td>
<td style="text-align: center;">11.2</td>
<td style="text-align: center;">29.0</td>
<td style="text-align: center;">50.6</td>
<td style="text-align: center;">13.6</td>
<td style="text-align: center;">4.4</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">6.6</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">2.8</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 4</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tabla_alta <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Any Lifestyle Comorbidity (%)</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Mean Number of Comorbidities</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 4: Prevalence (%) of Lifestyle-Related Comorbidities - Discharged Patients"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(tabla_alta)<span class="sc">-</span><span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#27ae60"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 4: Prevalence (%) of Lifestyle-Related Comorbidities - Discharged Patients</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Discharged Patients</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Obesity and Overweight</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Dyslipidemia and Metabolic Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Diabetes and Glucose Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Hypertension</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Tobacco Related Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Alcohol Related Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Other Substance Use</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Nutritional Deficiencies</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Non Alcoholic Liver Disease</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Sleep Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Cardiovascular Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Gastrointestinal Problems</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Musculoskeletal Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(39, 174, 96, 255) !important;">Mental Health Problems</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">48769</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">9.4</td>
<td style="text-align: center;">23.6</td>
<td style="text-align: center;">43.9</td>
<td style="text-align: center;">13.1</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">3.1</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">7.2</td>
<td style="text-align: center;">6.6</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">3.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">24813</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">9.5</td>
<td style="text-align: center;">22.4</td>
<td style="text-align: center;">43.4</td>
<td style="text-align: center;">15.8</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">9.9</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">13.9</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">2.7</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">7357</td>
<td style="text-align: center;">4.5</td>
<td style="text-align: center;">9.8</td>
<td style="text-align: center;">35.7</td>
<td style="text-align: center;">46.4</td>
<td style="text-align: center;">14.7</td>
<td style="text-align: center;">8.5</td>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">7.1</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">3.7</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">6193</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">11.2</td>
<td style="text-align: center;">29.2</td>
<td style="text-align: center;">50.3</td>
<td style="text-align: center;">13.6</td>
<td style="text-align: center;">4.4</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">6.9</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">7.3</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">2.9</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 5</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tabla_fallecidos <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Any Lifestyle Comorbidity (%)</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Mean Number of Comorbidities</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 5: Prevalence (%) of Lifestyle-Related Comorbidities - Deceased Patients"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(tabla_fallecidos)<span class="sc">-</span><span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#c0392b"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 5: Prevalence (%) of Lifestyle-Related Comorbidities - Deceased Patients</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Deceased Patients</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Obesity and Overweight</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Dyslipidemia and Metabolic Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Diabetes and Glucose Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Hypertension</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Tobacco Related Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Alcohol Related Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Other Substance Use</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Nutritional Deficiencies</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Non Alcoholic Liver Disease</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Sleep Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Cardiovascular Diseases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Gastrointestinal Problems</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Musculoskeletal Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(192, 57, 43, 255) !important;">Mental Health Problems</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">2482</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">9.6</td>
<td style="text-align: center;">27.8</td>
<td style="text-align: center;">54.5</td>
<td style="text-align: center;">18.2</td>
<td style="text-align: center;">7.7</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">14.1</td>
<td style="text-align: center;">9.5</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">18.7</td>
<td style="text-align: center;">16.1</td>
<td style="text-align: center;">1.4</td>
<td style="text-align: center;">3.4</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">1828</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">26.5</td>
<td style="text-align: center;">48.2</td>
<td style="text-align: center;">21.7</td>
<td style="text-align: center;">9.6</td>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">21.1</td>
<td style="text-align: center;">9.6</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">16.7</td>
<td style="text-align: center;">25.4</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">3.4</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">903</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">38.5</td>
<td style="text-align: center;">54.6</td>
<td style="text-align: center;">17.6</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">14.5</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">13.4</td>
<td style="text-align: center;">18.1</td>
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">3.4</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">736</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">27.6</td>
<td style="text-align: center;">53.1</td>
<td style="text-align: center;">14.1</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">12.9</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">12.6</td>
<td style="text-align: center;">14.1</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">2.2</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 6</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 6: Summary Statistics by Discharge Status (All Years: 2019-2023)"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(summary_stats)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#34495e"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 6: Summary Statistics by Discharge Status (All Years: 2019-2023)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Discharge Status</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Total Patients</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Mean Age</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Female (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Mean LOS (days)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Median LOS (days)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">SD LOS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Any Lifestyle Comorbidity (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Mean Comorbidities</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(52, 73, 94, 255) !important;">Patients with 3+ Comorbidities (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Deceased</td>
<td style="text-align: center;">5949</td>
<td style="text-align: center;">70.6</td>
<td style="text-align: center;">45.1</td>
<td style="text-align: center;">14.1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">19.0</td>
<td style="text-align: center;">80.9</td>
<td style="text-align: center;">1.91</td>
<td style="text-align: center;">31.3</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Discharged</td>
<td style="text-align: center;">87132</td>
<td style="text-align: center;">65.4</td>
<td style="text-align: center;">45.8</td>
<td style="text-align: center;">8.1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">12.2</td>
<td style="text-align: center;">66.3</td>
<td style="text-align: center;">1.35</td>
<td style="text-align: center;">18.3</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 7</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>los_analysis <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 7: Length of Stay Analysis by Cancer Site and Discharge Status"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(los_analysis)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#2c3e50"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 7: Length of Stay Analysis by Cancer Site and Discharge Status</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Discharge Status</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">N</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Mean LOS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Median LOS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">Deceased</td>
<td style="text-align: center;">2482</td>
<td style="text-align: center;">14.3</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">3 - 19</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">Discharged</td>
<td style="text-align: center;">48769</td>
<td style="text-align: center;">7.8</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">2 - 9</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">Deceased</td>
<td style="text-align: center;">736</td>
<td style="text-align: center;">11.5</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">3 - 16</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">Discharged</td>
<td style="text-align: center;">6193</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">3 - 12</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">Deceased</td>
<td style="text-align: center;">903</td>
<td style="text-align: center;">13.4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">3 - 17</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">Discharged</td>
<td style="text-align: center;">7357</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">2 - 13</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">Deceased</td>
<td style="text-align: center;">1828</td>
<td style="text-align: center;">15.1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2 - 20</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">Discharged</td>
<td style="text-align: center;">24813</td>
<td style="text-align: center;">8.1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1 - 10</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 8</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>yearly_trends <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 8: Yearly Trends in Cancer Cases and Outcomes (2019-2023)"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(yearly_trends)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">11</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#e67e22"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 8: Yearly Trends in Cancer Cases and Outcomes (2019-2023)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Year</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Total Cases</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Stomach</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Colorectal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Pancreas</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Gallbladder</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Mortality Rate (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Mean Age</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Mean LOS</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(230, 126, 34, 255) !important;">Any Comorbidity (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2019</td>
<td style="text-align: center;">22588</td>
<td style="text-align: center;">6562</td>
<td style="text-align: center;">12609</td>
<td style="text-align: center;">1836</td>
<td style="text-align: center;">1581</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">65.2</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">62.3</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2020</td>
<td style="text-align: center;">15259</td>
<td style="text-align: center;">4478</td>
<td style="text-align: center;">8197</td>
<td style="text-align: center;">1338</td>
<td style="text-align: center;">1246</td>
<td style="text-align: center;">7.4</td>
<td style="text-align: center;">65.3</td>
<td style="text-align: center;">8.8</td>
<td style="text-align: center;">65.4</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2021</td>
<td style="text-align: center;">15886</td>
<td style="text-align: center;">4604</td>
<td style="text-align: center;">8515</td>
<td style="text-align: center;">1435</td>
<td style="text-align: center;">1332</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">65.6</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">67.7</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">2022</td>
<td style="text-align: center;">18152</td>
<td style="text-align: center;">5204</td>
<td style="text-align: center;">9973</td>
<td style="text-align: center;">1653</td>
<td style="text-align: center;">1322</td>
<td style="text-align: center;">6.7</td>
<td style="text-align: center;">66.2</td>
<td style="text-align: center;">9.0</td>
<td style="text-align: center;">70.7</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">2023</td>
<td style="text-align: center;">21291</td>
<td style="text-align: center;">5834</td>
<td style="text-align: center;">11997</td>
<td style="text-align: center;">2004</td>
<td style="text-align: center;">1456</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">66.2</td>
<td style="text-align: center;">8.5</td>
<td style="text-align: center;">70.7</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 9: Mean LOS by Cancer Site and Comorbidities</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>los_comorbidity_table <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 9: Mean Length of Stay (days) by Cancer Site and Comorbidity"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(los_comorbidity_table)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#16a085"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 9: Mean Length of Stay (days) by Cancer Site and Comorbidity</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Obesity and Overweight</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Dyslipidemia and Metabolic</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Diabetes and Glucose</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Hypertension</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Tobacco Related</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Alcohol Related</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Other Substance Use</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Nutritional Deficiencies</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Non Alcoholic Liver</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Sleep Disorders</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Cardiovascular</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Gastrointestinal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Musculoskeletal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Mental Health</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">11.3</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">9.2</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">13.5</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">18.8</td>
<td style="text-align: center;">13.9</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">13.6</td>
<td style="text-align: center;">18.4</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">11.6</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">11.5</td>
<td style="text-align: center;">10.3</td>
<td style="text-align: center;">9.9</td>
<td style="text-align: center;">9.8</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">13.4</td>
<td style="text-align: center;">13.8</td>
<td style="text-align: center;">15.3</td>
<td style="text-align: center;">14.0</td>
<td style="text-align: center;">15.3</td>
<td style="text-align: center;">12.6</td>
<td style="text-align: center;">17.2</td>
<td style="text-align: center;">13.7</td>
<td style="text-align: center;">11.3</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">15.0</td>
<td style="text-align: center;">13.7</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">12.7</td>
<td style="text-align: center;">15.9</td>
<td style="text-align: center;">12.6</td>
<td style="text-align: center;">19.2</td>
<td style="text-align: center;">14.5</td>
<td style="text-align: center;">10.9</td>
<td style="text-align: center;">14.1</td>
<td style="text-align: center;">17.4</td>
<td style="text-align: center;">12.6</td>
<td style="text-align: center;">14.3</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">12.0</td>
<td style="text-align: center;">10.1</td>
<td style="text-align: center;">10.0</td>
<td style="text-align: center;">9.6</td>
<td style="text-align: center;">11.9</td>
<td style="text-align: center;">13.5</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">17.5</td>
<td style="text-align: center;">13.2</td>
<td style="text-align: center;">11.2</td>
<td style="text-align: center;">12.9</td>
<td style="text-align: center;">15.5</td>
<td style="text-align: center;">9.8</td>
<td style="text-align: center;">15.3</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 10: LOS Difference by Comorbidity Presence</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>los_diff_table <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"Table 10: Impact of Comorbidities on Length of Stay (Days difference: WITH - WITHOUT comorbidity)"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'l'</span>, <span class="fu">rep</span>(<span class="st">'c'</span>, <span class="fu">ncol</span>(los_diff_table)<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#8b4513"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Table 10: Impact of Comorbidities on Length of Stay (Days difference: WITH - WITHOUT comorbidity)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Cancer Site</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Obesity</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Dyslipidemia</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Diabetes</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Hypertension</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Tobacco</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Alcohol</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Substance Use</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Nutritional</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Liver Disease</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Sleep</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Cardiovascular</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Gastrointestinal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Musculoskeletal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(139, 69, 19, 255) !important;">Mental Health</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Colorectal</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">11.4</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">5.9</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">3.6</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Gallbladder</td>
<td style="text-align: center;">2.4</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">4.5</td>
<td style="text-align: center;">6.2</td>
<td style="text-align: center;">5.1</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">8.4</td>
<td style="text-align: center;">4.4</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Pancreas</td>
<td style="text-align: center;">5.1</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">6.3</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">4.7</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">8.1</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">4.3</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Stomach</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">10.0</td>
<td style="text-align: center;">4.9</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">7.0</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmaps</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(tabla_total, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Heatmap: Lifestyle Comorbidities in All Cancer Patients"</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">viridis_option =</span> <span class="st">"D"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(tabla_alta, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Heatmap: Lifestyle Comorbidities in Discharged Cancer Patients"</span>, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">viridis_option =</span> <span class="st">"C"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(tabla_fallecidos, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Heatmap: Lifestyle Comorbidities in Deceased Cancer Patients"</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">viridis_option =</span> <span class="st">"C"</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced heatmap for mortality differences with p-values</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>create_mortality_diff_heatmap_with_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>(deceased_table, discharged_table, p_values) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  heatmap_deceased <span class="ot">&lt;-</span> deceased_table <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Patients"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Comorbidity"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Number"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"Cancer Site"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  heatmap_discharged <span class="ot">&lt;-</span> discharged_table <span class="sc">|&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Patients"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Comorbidity"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Number"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"Cancer Site"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  heatmap_diff <span class="ot">&lt;-</span> heatmap_deceased <span class="sc">-</span> heatmap_discharged</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  p_values_formatted <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">""</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(p_values), <span class="at">ncol =</span> <span class="fu">ncol</span>(p_values))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p_values)) {</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(p_values)) {</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_values[i,j])) {</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(p_values[i,j] <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>          p_values_formatted[i,j] <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(p_values[i,j] <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>          p_values_formatted[i,j] <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(p_values[i,j] <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>          p_values_formatted[i,j] <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  heatmap_diff_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(heatmap_diff)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(heatmap_diff_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cancer Site"</span>, <span class="st">"Comorbidity"</span>, <span class="st">"Difference"</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  p_values_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(p_values_formatted)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  heatmap_diff_long<span class="sc">$</span>significance <span class="ot">&lt;-</span> p_values_long<span class="sc">$</span>value</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(heatmap_diff_long, <span class="fu">aes</span>(<span class="at">x =</span> Comorbidity, <span class="at">y =</span> <span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span>, <span class="at">fill =</span> Difference)) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">name =</span> <span class="st">"Difference (%)</span><span class="sc">\n</span><span class="st">(Deceased - Discharged)"</span>,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>                        <span class="at">low =</span> <span class="st">"#2ecc71"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#e74c3c"</span>,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                        <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">"%+.1f"</span>, Difference), significance)), </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Difference in Comorbidity Prevalence: Deceased vs Discharged"</span>,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Red: higher in deceased | Green: higher in discharged"</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"*** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05 (Chi-square/Fisher's exact test)"</span>,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced heatmap for LOS differences with p-values</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>create_los_diff_heatmap_with_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>(los_diff_table, p_values) {</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>  los_diff_data <span class="ot">&lt;-</span> los_diff_table <span class="sc">|&gt;</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"Cancer Site"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>  los_diff_data[<span class="fu">is.nan</span>(los_diff_data)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>  p_values_formatted <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">""</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(p_values), <span class="at">ncol =</span> <span class="fu">ncol</span>(p_values))</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p_values)) {</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(p_values)) {</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_values[i,j])) {</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(p_values[i,j] <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>          p_values_formatted[i,j] <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(p_values[i,j] <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>          p_values_formatted[i,j] <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span>(p_values[i,j] <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>          p_values_formatted[i,j] <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  los_diff_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(los_diff_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(los_diff_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cancer Site"</span>, <span class="st">"Comorbidity"</span>, <span class="st">"LOS_Difference"</span>)</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>  p_values_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(p_values_formatted)</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>  los_diff_long<span class="sc">$</span>significance <span class="ot">&lt;-</span> p_values_long<span class="sc">$</span>value[<span class="sc">!</span><span class="fu">is.na</span>(los_diff_long<span class="sc">$</span>LOS_Difference)]</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(los_diff_long, <span class="fu">aes</span>(<span class="at">x =</span> Comorbidity, <span class="at">y =</span> <span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span>, <span class="at">fill =</span> LOS_Difference)) <span class="sc">+</span></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">name =</span> <span class="st">"LOS Difference</span><span class="sc">\n</span><span class="st">(days)"</span>, </span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>                       <span class="at">low =</span> <span class="st">"#3498db"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#e74c3c"</span>,</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.value =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">"%+.1f"</span>, LOS_Difference), significance)), </span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Impact of Comorbidities on Length of Stay"</span>,</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Difference in mean LOS: patients WITH comorbidity - WITHOUT (red = longer stay)"</span>,</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"*** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05 (Wilcoxon rank-sum test)"</span>,</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>p_mortality_diff <span class="ot">&lt;-</span> <span class="fu">create_mortality_diff_heatmap_with_pvalues</span>(</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>  tabla_fallecidos, </span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>  tabla_alta,</span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>  mortality_pvalues</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>p_los_diff <span class="ot">&lt;-</span> <span class="fu">create_los_diff_heatmap_with_pvalues</span>(</span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>  los_diff_table,</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>  los_pvalues</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_mortality_diff)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_los_diff)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap for mean LOS by cancer and comorbidities</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>los_heatmap_data <span class="ot">&lt;-</span> los_comorbidity_table <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Cancer Site"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>los_heatmap_data[<span class="fu">is.nan</span>(los_heatmap_data)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>los_heatmap_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(los_heatmap_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(los_heatmap_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cancer Site"</span>, <span class="st">"Comorbidity"</span>, <span class="st">"Mean_LOS"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>p_los_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(los_heatmap_long, <span class="fu">aes</span>(<span class="at">x =</span> Comorbidity, <span class="at">y =</span> <span class="st">`</span><span class="at">Cancer Site</span><span class="st">`</span>, <span class="at">fill =</span> Mean_LOS)) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">name =</span> <span class="st">"Mean LOS</span><span class="sc">\n</span><span class="st">(days)"</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">option =</span> <span class="st">"A"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Length of Stay by Cancer Site and Comorbidity"</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Days of hospitalization for patients with each comorbidity"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, Mean_LOS)), </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_los_heatmap)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trend plots</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>trend_plot <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, cancer_site) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mortality_rate =</span> <span class="fu">mean</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>p_trend <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trend_plot, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> count, <span class="at">color =</span> cancer_site)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cancer Cases Trend by Site (2019-2023)"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Cases"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Cancer Site"</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_trend)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>p_mortality <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(trend_plot, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mortality_rate, <span class="at">color =</span> cancer_site)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mortality Rate Trend by Cancer Site (2019-2023)"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mortality Rate (%)"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Cancer Site"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_mortality)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MODELS SECTION</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for modeling</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>data_cancer <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">egresar_fallecido =</span> <span class="fu">ifelse</span>(estado_alta <span class="sc">==</span> <span class="st">"Deceased"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_factor =</span> <span class="fu">factor</span>(year, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2021</span>, <span class="dv">2022</span>, <span class="dv">2023</span>)),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">IR_29301_SEVERIDAD =</span> <span class="fu">factor</span>(IR_29301_SEVERIDAD, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>)),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">IR_29301_MORTALIDAD =</span> <span class="fu">factor</span>(IR_29301_MORTALIDAD, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low risk"</span>, <span class="st">"Medium risk"</span>, <span class="st">"High risk"</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify significant comorbidities</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>identify_significant_comorbidities <span class="ot">&lt;-</span> <span class="cf">function</span>(p_matrix, <span class="at">threshold =</span> <span class="fl">0.05</span>) {</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  sig_vars <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">rownames</span>(p_matrix)) {</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    sig_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(p_matrix[cancer, ] <span class="sc">&lt;</span> threshold)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(sig_indices) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>      sig_vars[[cancer]] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(p_matrix)[sig_indices]</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>      sig_vars[[cancer]] <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="dv">0</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sig_vars)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>sig_mortality_vars <span class="ot">&lt;-</span> <span class="fu">identify_significant_comorbidities</span>(mortality_pvalues, <span class="fl">0.05</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>sig_los_vars <span class="ot">&lt;-</span> <span class="fu">identify_significant_comorbidities</span>(los_pvalues, <span class="fl">0.05</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets for each cancer type</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>cancer_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(data_cancer<span class="sc">$</span>cancer_site)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> cancer_types) {</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  datasets[[cancer]] <span class="ot">&lt;-</span> data_cancer <span class="sc">|&gt;</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cancer_site <span class="sc">==</span> cancer) <span class="sc">|&gt;</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">complete.cases</span>(EDAD, SEXO, service_category, year_factor, length_of_stay,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>                         IR_29301_SEVERIDAD, IR_29301_MORTALIDAD))</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to clean variable names</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>clean_var_names <span class="ot">&lt;-</span> <span class="cf">function</span>(var_names) {</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(Intercept</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">"Intercept"</span>, var_names)</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"SEXOMUJER"</span>, <span class="st">"Sex Female"</span>, var_names)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"EDAD"</span>, <span class="st">"Age"</span>, var_names)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"service_categoryICU"</span>, <span class="st">"Service ICU"</span>, var_names)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"service_categoryITU"</span>, <span class="st">"Service ITU"</span>, var_names)</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"service_categoryMS"</span>, <span class="st">"Service MS"</span>, var_names)</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"service_categoryOthers"</span>, <span class="st">"Service Others"</span>, var_names)</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"year_factor"</span>, <span class="st">"Year "</span>, var_names)</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"IR_29301_SEVERIDADMedium"</span>, <span class="st">"Severity Medium"</span>, var_names)</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"IR_29301_SEVERIDADHigh"</span>, <span class="st">"Severity High"</span>, var_names)</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"IR_29301_MORTALIDADMedium risk"</span>, <span class="st">"Mortality Risk Medium"</span>, var_names)</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"IR_29301_MORTALIDADHigh risk"</span>, <span class="st">"Mortality Risk High"</span>, var_names)</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"obesity_overweight"</span>, <span class="st">"Obesity Overweight"</span>, var_names)</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"dyslipidemia_metabolic"</span>, <span class="st">"Dyslipidemia"</span>, var_names)</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"diabetes_glucose"</span>, <span class="st">"Diabetes"</span>, var_names)</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"hypertension"</span>, <span class="st">"Hypertension"</span>, var_names)</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"tobacco_related"</span>, <span class="st">"Tobacco Related"</span>, var_names)</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"alcohol_related"</span>, <span class="st">"Alcohol Related"</span>, var_names)</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"substance_use"</span>, <span class="st">"Substance Use"</span>, var_names)</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"nutritional_problems"</span>, <span class="st">"Nutritional Problems"</span>, var_names)</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"liver_disease_nonalcoholic"</span>, <span class="st">"Liver Disease"</span>, var_names)</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"sleep_disorders"</span>, <span class="st">"Sleep Disorders"</span>, var_names)</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"cardiovascular_lifestyle"</span>, <span class="st">"Cardiovascular"</span>, var_names)</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"gastrointestinal_lifestyle"</span>, <span class="st">"Gastrointestinal"</span>, var_names)</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"musculoskeletal_sedentary"</span>, <span class="st">"Musculoskeletal"</span>, var_names)</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>  var_names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"mental_health_lifestyle"</span>, <span class="st">"Mental Health"</span>, var_names)</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(var_names)</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to format effects</span></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>format_effect <span class="ot">&lt;-</span> <span class="cf">function</span>(estimate, ci_lower, ci_upper, p_value) {</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>  stars <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"***"</span>,</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>,</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, <span class="st">""</span>)))</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.3f [%.3f, %.3f]%s"</span>, estimate, ci_lower, ci_upper, stars)</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a><span class="co"># REFINED MODELS</span></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>logistic_models_refined <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>logistic_results_refined <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>logistic_performance_refined <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> cancer_types) {</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>    base_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EDAD"</span>, <span class="st">"SEXO"</span>, <span class="st">"service_category"</span>, <span class="st">"year_factor"</span>,</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"IR_29301_SEVERIDAD"</span>, <span class="st">"IR_29301_MORTALIDAD"</span>)</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>    model_vars <span class="ot">&lt;-</span> base_vars</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(cancer <span class="sc">%in%</span> <span class="fu">names</span>(sig_mortality_vars) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(sig_mortality_vars[[cancer]]) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>      model_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(model_vars, sig_mortality_vars[[cancer]])</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>    formula_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"egresar_fallecido ~"</span>, <span class="fu">paste</span>(model_vars, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="st">"+ (1|year_factor)"</span>)</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>    model_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(formula_text)</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">glmer</span>(</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>      model_formula,</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> datasets[[cancer]],</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>))</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>    logistic_models_refined[[cancer]] <span class="ot">&lt;-</span> model</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>    fixed_effects <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>    results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="fu">rownames</span>(fixed_effects),</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coefficient =</span> fixed_effects[, <span class="st">"Estimate"</span>],</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> fixed_effects[, <span class="st">"Std. Error"</span>],</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">OR =</span> <span class="fu">exp</span>(fixed_effects[, <span class="st">"Estimate"</span>]),</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">CI_Lower =</span> <span class="fu">exp</span>(fixed_effects[, <span class="st">"Estimate"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> fixed_effects[, <span class="st">"Std. Error"</span>]),</span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">CI_Upper =</span> <span class="fu">exp</span>(fixed_effects[, <span class="st">"Estimate"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> fixed_effects[, <span class="st">"Std. Error"</span>]),</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">z_value =</span> fixed_effects[, <span class="st">"z value"</span>],</span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">P_Value =</span> fixed_effects[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>    logistic_results_refined[[cancer]] <span class="ot">&lt;-</span> results_df</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>    pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>    observed <span class="ot">&lt;-</span> datasets[[cancer]]<span class="sc">$</span>egresar_fallecido</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>    roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(observed, pred_probs, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a>    auc_val <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">auc</span>(roc_obj))</span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>    null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(egresar_fallecido <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> datasets[[cancer]], <span class="at">family =</span> binomial)</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>    ll_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(model))</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>    ll_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a>    mcfadden <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (ll_full <span class="sc">/</span> ll_null)</span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a>    cox_snell <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">/</span>n) <span class="sc">*</span> (ll_null <span class="sc">-</span> ll_full))</span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a>    nagelkerke <span class="ot">&lt;-</span> cox_snell <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> ll_null <span class="sc">/</span> n))</span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>    logistic_performance_refined[[cancer]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cancer =</span> cancer,</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> n,</span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">Events =</span> <span class="fu">sum</span>(observed),</span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a>      <span class="at">EventRate =</span> <span class="fu">mean</span>(observed) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Comorbidities =</span> <span class="fu">length</span>(sig_mortality_vars[[cancer]]),</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">AIC =</span> <span class="fu">AIC</span>(model),</span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">BIC =</span> <span class="fu">BIC</span>(model),</span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>      <span class="at">LogLik =</span> ll_full,</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a>      <span class="at">AUC =</span> auc_val,</span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a>      <span class="at">McFadden =</span> mcfadden,</span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">CoxSnell =</span> cox_snell,</span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">Nagelkerke =</span> nagelkerke</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Silent error handling</span></span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a>nb_models_refined <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a>nb_results_refined <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a>nb_performance_refined <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> cancer_types) {</span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a>    base_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EDAD"</span>, <span class="st">"SEXO"</span>, <span class="st">"service_category"</span>, <span class="st">"year_factor"</span>,</span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"IR_29301_SEVERIDAD"</span>, <span class="st">"IR_29301_MORTALIDAD"</span>)</span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a>    model_vars <span class="ot">&lt;-</span> base_vars</span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(cancer <span class="sc">%in%</span> <span class="fu">names</span>(sig_los_vars) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(sig_los_vars[[cancer]]) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a>      model_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(model_vars, sig_los_vars[[cancer]])</span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a>    formula_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"length_of_stay ~"</span>, <span class="fu">paste</span>(model_vars, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="st">"+ (1|year_factor)"</span>)</span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a>    model_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(formula_text)</span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">glmmTMB</span>(</span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a>      model_formula,</span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> datasets[[cancer]],</span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> nbinom2,</span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">glmmTMBControl</span>(<span class="at">optimizer =</span> nlminb, <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">eval.max =</span> <span class="dv">1000</span>, <span class="at">iter.max =</span> <span class="dv">1000</span>))</span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a>    nb_models_refined[[cancer]] <span class="ot">&lt;-</span> model</span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a>    fixed_effects <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients<span class="sc">$</span>cond</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a>    results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="fu">rownames</span>(fixed_effects),</span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a>      <span class="at">Coefficient =</span> fixed_effects[, <span class="st">"Estimate"</span>],</span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> fixed_effects[, <span class="st">"Std. Error"</span>],</span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a>      <span class="at">IRR =</span> <span class="fu">exp</span>(fixed_effects[, <span class="st">"Estimate"</span>]),</span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a>      <span class="at">CI_Lower =</span> <span class="fu">exp</span>(fixed_effects[, <span class="st">"Estimate"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> fixed_effects[, <span class="st">"Std. Error"</span>]),</span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a>      <span class="at">CI_Upper =</span> <span class="fu">exp</span>(fixed_effects[, <span class="st">"Estimate"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> fixed_effects[, <span class="st">"Std. Error"</span>]),</span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a>      <span class="at">z_value =</span> fixed_effects[, <span class="st">"z value"</span>],</span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a>      <span class="at">P_Value =</span> fixed_effects[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a>    nb_results_refined[[cancer]] <span class="ot">&lt;-</span> results_df</span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a>    fitted_vals <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)</span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a>    observed_vals <span class="ot">&lt;-</span> datasets[[cancer]]<span class="sc">$</span>length_of_stay</span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> observed_vals <span class="sc">-</span> fitted_vals</span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>    null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(length_of_stay <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> datasets[[cancer]], <span class="at">family =</span> poisson)</span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a>    ll_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(model))</span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a>    ll_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a>    mcfadden <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (ll_full <span class="sc">/</span> ll_null)</span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a>    rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(residuals<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a>    mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(residuals))</span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a>    nb_performance_refined[[cancer]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-215"><a href="#cb20-215" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cancer =</span> cancer,</span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> n,</span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a>      <span class="at">MeanLOS =</span> <span class="fu">mean</span>(observed_vals),</span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a>      <span class="at">SDLOS =</span> <span class="fu">sd</span>(observed_vals),</span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a>      <span class="at">N_Comorbidities =</span> <span class="fu">length</span>(sig_los_vars[[cancer]]),</span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a>      <span class="at">AIC =</span> <span class="fu">AIC</span>(model),</span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">BIC =</span> <span class="fu">BIC</span>(model),</span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a>      <span class="at">LogLik =</span> ll_full,</span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE =</span> rmse,</span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a>      <span class="at">MAE =</span> mae,</span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a>      <span class="at">McFadden =</span> mcfadden</span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-228"><a href="#cb20-228" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb20-229"><a href="#cb20-229" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Silent error handling</span></span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Consolidated tables for refined models</span></span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a>all_vars_log <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(logistic_results_refined, <span class="cf">function</span>(x) x<span class="sc">$</span>Variable)))</span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a>all_vars_log <span class="ot">&lt;-</span> all_vars_log[all_vars_log <span class="sc">!=</span> <span class="st">"(Intercept)"</span>]</span>
<span id="cb20-236"><a href="#cb20-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-237"><a href="#cb20-237" aria-hidden="true" tabindex="-1"></a>logistic_consolidated <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">clean_var_names</span>(all_vars_log))</span>
<span id="cb20-238"><a href="#cb20-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-239"><a href="#cb20-239" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> cancer_types) {</span>
<span id="cb20-240"><a href="#cb20-240" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cancer <span class="sc">%in%</span> <span class="fu">names</span>(logistic_results_refined)) {</span>
<span id="cb20-241"><a href="#cb20-241" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> logistic_results_refined[[cancer]]</span>
<span id="cb20-242"><a href="#cb20-242" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>Variable_clean <span class="ot">&lt;-</span> <span class="fu">clean_var_names</span>(df<span class="sc">$</span>Variable)</span>
<span id="cb20-243"><a href="#cb20-243" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-244"><a href="#cb20-244" aria-hidden="true" tabindex="-1"></a>    effects <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="fu">length</span>(logistic_consolidated<span class="sc">$</span>Variable))</span>
<span id="cb20-245"><a href="#cb20-245" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-246"><a href="#cb20-246" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(logistic_consolidated)) {</span>
<span id="cb20-247"><a href="#cb20-247" aria-hidden="true" tabindex="-1"></a>      var <span class="ot">&lt;-</span> logistic_consolidated<span class="sc">$</span>Variable[i]</span>
<span id="cb20-248"><a href="#cb20-248" aria-hidden="true" tabindex="-1"></a>      idx <span class="ot">&lt;-</span> <span class="fu">which</span>(df<span class="sc">$</span>Variable_clean <span class="sc">==</span> var)</span>
<span id="cb20-249"><a href="#cb20-249" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-250"><a href="#cb20-250" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb20-251"><a href="#cb20-251" aria-hidden="true" tabindex="-1"></a>        effects[i] <span class="ot">&lt;-</span> <span class="fu">format_effect</span>(df<span class="sc">$</span>OR[idx], df<span class="sc">$</span>CI_Lower[idx], </span>
<span id="cb20-252"><a href="#cb20-252" aria-hidden="true" tabindex="-1"></a>                                   df<span class="sc">$</span>CI_Upper[idx], df<span class="sc">$</span>P_Value[idx])</span>
<span id="cb20-253"><a href="#cb20-253" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb20-254"><a href="#cb20-254" aria-hidden="true" tabindex="-1"></a>        effects[i] <span class="ot">&lt;-</span> <span class="st">"—"</span></span>
<span id="cb20-255"><a href="#cb20-255" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb20-256"><a href="#cb20-256" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-257"><a href="#cb20-257" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-258"><a href="#cb20-258" aria-hidden="true" tabindex="-1"></a>    logistic_consolidated[[cancer]] <span class="ot">&lt;-</span> effects</span>
<span id="cb20-259"><a href="#cb20-259" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-260"><a href="#cb20-260" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-261"><a href="#cb20-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-262"><a href="#cb20-262" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(logistic_consolidated,</span>
<span id="cb20-263"><a href="#cb20-263" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"&lt;b&gt;Table: Logistic regression mixed models - Odds Ratios for In-Hospital Mortality&lt;/b&gt;"</span>,</span>
<span id="cb20-264"><a href="#cb20-264" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb20-265"><a href="#cb20-265" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-266"><a href="#cb20-266" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-267"><a href="#cb20-267" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="fu">rep</span>(<span class="st">"c"</span>, <span class="fu">length</span>(cancer_types)))) <span class="sc">|&gt;</span></span>
<span id="cb20-268"><a href="#cb20-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb20-269"><a href="#cb20-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb20-270"><a href="#cb20-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-271"><a href="#cb20-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">font_size =</span> <span class="dv">10</span></span>
<span id="cb20-272"><a href="#cb20-272" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb20-273"><a href="#cb20-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#2c3e50"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-274"><a href="#cb20-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="fu">c</span>(<span class="st">"Values shown as OR [95% CI]"</span>,</span>
<span id="cb20-275"><a href="#cb20-275" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05"</span>,</span>
<span id="cb20-276"><a href="#cb20-276" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Models include only comorbidities significant at p&lt;0.05 in bivariate analysis"</span>,</span>
<span id="cb20-277"><a href="#cb20-277" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Reference categories: Male sex, Others service, Year 2019, Low severity, Low mortality risk"</span>),</span>
<span id="cb20-278"><a href="#cb20-278" aria-hidden="true" tabindex="-1"></a>           <span class="at">footnote_as_chunk =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption><strong>Table: Logistic regression mixed models - Odds Ratios for In-Hospital Mortality</strong></caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Variable</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Stomach</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Gallbladder</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Colorectal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Pancreas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: center;">1.016 [1.011, 1.021]***</td>
<td style="text-align: center;">1.018 [1.010, 1.026]***</td>
<td style="text-align: center;">1.034 [1.030, 1.038]***</td>
<td style="text-align: center;">1.034 [1.027, 1.041]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex Female</td>
<td style="text-align: center;">1.094 [0.980, 1.222]</td>
<td style="text-align: center;">0.886 [0.746, 1.053]</td>
<td style="text-align: center;">1.029 [0.941, 1.124]</td>
<td style="text-align: center;">0.883 [0.759, 1.026]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Service ICU</td>
<td style="text-align: center;">1.128 [0.951, 1.339]</td>
<td style="text-align: center;">0.978 [0.736, 1.300]</td>
<td style="text-align: center;">1.570 [1.376, 1.793]***</td>
<td style="text-align: center;">1.225 [0.964, 1.556]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Service ITU</td>
<td style="text-align: center;">0.982 [0.796, 1.211]</td>
<td style="text-align: center;">0.952 [0.652, 1.390]</td>
<td style="text-align: center;">1.036 [0.880, 1.219]</td>
<td style="text-align: center;">1.052 [0.758, 1.460]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Service MS</td>
<td style="text-align: center;">0.833 [0.741, 0.937]**</td>
<td style="text-align: center;">0.601 [0.501, 0.720]***</td>
<td style="text-align: center;">0.827 [0.745, 0.917]***</td>
<td style="text-align: center;">0.801 [0.676, 0.948]*</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year 2020</td>
<td style="text-align: center;">1.080 [0.918, 1.269]</td>
<td style="text-align: center;">0.887 [0.688, 1.145]</td>
<td style="text-align: center;">0.936 [0.812, 1.080]</td>
<td style="text-align: center;">0.773 [0.606, 0.985]*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year 2021</td>
<td style="text-align: center;">1.007 [0.853, 1.188]</td>
<td style="text-align: center;">0.670 [0.515, 0.871]**</td>
<td style="text-align: center;">0.818 [0.708, 0.945]**</td>
<td style="text-align: center;">0.617 [0.482, 0.791]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year 2022</td>
<td style="text-align: center;">0.809 [0.687, 0.952]*</td>
<td style="text-align: center;">0.732 [0.566, 0.947]*</td>
<td style="text-align: center;">0.749 [0.651, 0.860]***</td>
<td style="text-align: center;">0.636 [0.502, 0.806]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year 2023</td>
<td style="text-align: center;">0.648 [0.550, 0.765]***</td>
<td style="text-align: center;">0.682 [0.528, 0.881]**</td>
<td style="text-align: center;">0.656 [0.572, 0.752]***</td>
<td style="text-align: center;">0.607 [0.483, 0.763]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Severity Medium</td>
<td style="text-align: center;">2.311 [1.809, 2.951]***</td>
<td style="text-align: center;">1.203 [0.871, 1.662]</td>
<td style="text-align: center;">1.431 [1.109, 1.846]**</td>
<td style="text-align: center;">1.530 [1.134, 2.063]**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Severity High</td>
<td style="text-align: center;">19.003 [15.050, 23.993]***</td>
<td style="text-align: center;">5.376 [3.903, 7.406]***</td>
<td style="text-align: center;">10.078 [7.790, 13.039]***</td>
<td style="text-align: center;">7.343 [5.454, 9.886]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mortality Risk Medium</td>
<td style="text-align: center;">0.844 [0.625, 1.140]</td>
<td style="text-align: center;">1.271 [0.829, 1.947]</td>
<td style="text-align: center;">1.488 [1.117, 1.981]**</td>
<td style="text-align: center;">0.817 [0.561, 1.190]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mortality Risk High</td>
<td style="text-align: center;">2.375 [1.870, 3.016]***</td>
<td style="text-align: center;">2.303 [1.644, 3.228]***</td>
<td style="text-align: center;">5.003 [3.745, 6.684]***</td>
<td style="text-align: center;">1.593 [1.183, 2.146]**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diabetes</td>
<td style="text-align: center;">0.995 [0.876, 1.130]</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">0.865 [0.778, 0.961]**</td>
<td style="text-align: center;">—</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hypertension</td>
<td style="text-align: center;">0.861 [0.764, 0.969]*</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">0.913 [0.827, 1.009]</td>
<td style="text-align: center;">0.923 [0.788, 1.081]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tobacco Related</td>
<td style="text-align: center;">0.975 [0.858, 1.109]</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">0.973 [0.866, 1.093]</td>
<td style="text-align: center;">0.940 [0.769, 1.148]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol Related</td>
<td style="text-align: center;">0.896 [0.745, 1.078]</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">0.977 [0.816, 1.169]</td>
<td style="text-align: center;">—</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nutritional Problems</td>
<td style="text-align: center;">0.688 [0.603, 0.785]***</td>
<td style="text-align: center;">0.703 [0.501, 0.987]*</td>
<td style="text-align: center;">0.810 [0.711, 0.923]**</td>
<td style="text-align: center;">0.633 [0.494, 0.811]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Liver Disease</td>
<td style="text-align: center;">1.573 [1.302, 1.900]***</td>
<td style="text-align: center;">1.123 [0.869, 1.452]</td>
<td style="text-align: center;">1.674 [1.426, 1.966]***</td>
<td style="text-align: center;">1.712 [1.359, 2.155]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cardiovascular</td>
<td style="text-align: center;">0.977 [0.844, 1.131]</td>
<td style="text-align: center;">1.045 [0.806, 1.356]</td>
<td style="text-align: center;">1.123 [0.994, 1.268]</td>
<td style="text-align: center;">0.961 [0.760, 1.215]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gastrointestinal</td>
<td style="text-align: center;">1.141 [1.005, 1.295]*</td>
<td style="text-align: center;">1.670 [1.297, 2.149]***</td>
<td style="text-align: center;">1.150 [1.009, 1.310]*</td>
<td style="text-align: center;">1.385 [1.128, 1.701]**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Obesity Overweight</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">1.015 [0.848, 1.216]</td>
<td style="text-align: center;">—</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Values shown as OR [95% CI]</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Models include only comorbidities significant at p&lt;0.05 in bivariate analysis</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Reference categories: Male sex, Others service, Year 2019, Low severity, Low mortality risk</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>all_vars_nb <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(nb_results_refined, <span class="cf">function</span>(x) x<span class="sc">$</span>Variable)))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>all_vars_nb <span class="ot">&lt;-</span> all_vars_nb[all_vars_nb <span class="sc">!=</span> <span class="st">"(Intercept)"</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>nb_consolidated <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">clean_var_names</span>(all_vars_nb))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> cancer_types) {</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cancer <span class="sc">%in%</span> <span class="fu">names</span>(nb_results_refined)) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> nb_results_refined[[cancer]]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>Variable_clean <span class="ot">&lt;-</span> <span class="fu">clean_var_names</span>(df<span class="sc">$</span>Variable)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    effects <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="fu">length</span>(nb_consolidated<span class="sc">$</span>Variable))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(nb_consolidated)) {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>      var <span class="ot">&lt;-</span> nb_consolidated<span class="sc">$</span>Variable[i]</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>      idx <span class="ot">&lt;-</span> <span class="fu">which</span>(df<span class="sc">$</span>Variable_clean <span class="sc">==</span> var)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        effects[i] <span class="ot">&lt;-</span> <span class="fu">format_effect</span>(df<span class="sc">$</span>IRR[idx], df<span class="sc">$</span>CI_Lower[idx], </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                                   df<span class="sc">$</span>CI_Upper[idx], df<span class="sc">$</span>P_Value[idx])</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        effects[i] <span class="ot">&lt;-</span> <span class="st">"—"</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    nb_consolidated[[cancer]] <span class="ot">&lt;-</span> effects</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(nb_consolidated,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"&lt;b&gt;Table: Negative Binomial Mixed Models - Incidence Rate Ratios for Length of Stay&lt;/b&gt;"</span>,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="fu">rep</span>(<span class="st">"c"</span>, <span class="fu">length</span>(cancer_types)))) <span class="sc">|&gt;</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">font_size =</span> <span class="dv">10</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#e74c3c"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="fu">c</span>(<span class="st">"Values shown as IRR [95% CI]"</span>,</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"*** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05"</span>,</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Models include only comorbidities significant at p&lt;0.05 in bivariate analysis"</span>,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Reference categories: Male sex, Others service, Year 2019, Low severity, Low mortality risk"</span>),</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">footnote_as_chunk =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption><strong>Table: Negative Binomial Mixed Models - Incidence Rate Ratios for Length of Stay</strong></caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(231, 76, 60, 255) !important;">Variable</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(231, 76, 60, 255) !important;">Stomach</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(231, 76, 60, 255) !important;">Gallbladder</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(231, 76, 60, 255) !important;">Colorectal</th>
<th data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(231, 76, 60, 255) !important;">Pancreas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: center;">1.001 [1.000, 1.002]</td>
<td style="text-align: center;">1.001 [0.998, 1.003]</td>
<td style="text-align: center;">1.001 [1.001, 1.002]***</td>
<td style="text-align: center;">0.998 [0.997, 1.000]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex Female</td>
<td style="text-align: center;">0.992 [0.966, 1.018]</td>
<td style="text-align: center;">0.947 [0.904, 0.993]*</td>
<td style="text-align: center;">0.967 [0.952, 0.982]***</td>
<td style="text-align: center;">0.986 [0.944, 1.030]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Service ICU</td>
<td style="text-align: center;">1.460 [1.396, 1.527]***</td>
<td style="text-align: center;">1.139 [1.047, 1.239]**</td>
<td style="text-align: center;">1.518 [1.476, 1.561]***</td>
<td style="text-align: center;">1.333 [1.236, 1.436]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Service ITU</td>
<td style="text-align: center;">1.450 [1.367, 1.537]***</td>
<td style="text-align: center;">0.992 [0.879, 1.120]</td>
<td style="text-align: center;">1.551 [1.494, 1.611]***</td>
<td style="text-align: center;">1.396 [1.256, 1.551]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Service MS</td>
<td style="text-align: center;">1.446 [1.408, 1.486]***</td>
<td style="text-align: center;">1.145 [1.089, 1.203]***</td>
<td style="text-align: center;">1.535 [1.509, 1.563]***</td>
<td style="text-align: center;">1.464 [1.395, 1.535]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year 2020</td>
<td style="text-align: center;">0.897 [0.864, 0.932]***</td>
<td style="text-align: center;">1.035 [0.966, 1.108]</td>
<td style="text-align: center;">0.957 [0.933, 0.981]***</td>
<td style="text-align: center;">0.972 [0.906, 1.043]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year 2021</td>
<td style="text-align: center;">0.883 [0.850, 0.918]***</td>
<td style="text-align: center;">0.989 [0.924, 1.059]</td>
<td style="text-align: center;">0.959 [0.936, 0.984]**</td>
<td style="text-align: center;">0.922 [0.860, 0.989]*</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year 2022</td>
<td style="text-align: center;">0.872 [0.839, 0.905]***</td>
<td style="text-align: center;">1.018 [0.950, 1.090]</td>
<td style="text-align: center;">0.898 [0.876, 0.920]***</td>
<td style="text-align: center;">0.915 [0.855, 0.980]*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year 2023</td>
<td style="text-align: center;">0.829 [0.799, 0.861]***</td>
<td style="text-align: center;">0.919 [0.859, 0.984]*</td>
<td style="text-align: center;">0.874 [0.853, 0.894]***</td>
<td style="text-align: center;">0.893 [0.836, 0.954]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Severity Medium</td>
<td style="text-align: center;">1.452 [1.404, 1.501]***</td>
<td style="text-align: center;">1.288 [1.212, 1.369]***</td>
<td style="text-align: center;">1.384 [1.355, 1.414]***</td>
<td style="text-align: center;">1.374 [1.295, 1.459]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Severity High</td>
<td style="text-align: center;">3.041 [2.922, 3.164]***</td>
<td style="text-align: center;">2.091 [1.945, 2.248]***</td>
<td style="text-align: center;">2.866 [2.783, 2.952]***</td>
<td style="text-align: center;">2.378 [2.217, 2.550]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mortality Risk Medium</td>
<td style="text-align: center;">0.889 [0.848, 0.931]***</td>
<td style="text-align: center;">1.098 [1.012, 1.190]*</td>
<td style="text-align: center;">0.819 [0.801, 0.838]***</td>
<td style="text-align: center;">1.001 [0.924, 1.084]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mortality Risk High</td>
<td style="text-align: center;">0.713 [0.689, 0.738]***</td>
<td style="text-align: center;">0.937 [0.882, 0.996]*</td>
<td style="text-align: center;">0.792 [0.771, 0.815]***</td>
<td style="text-align: center;">0.734 [0.690, 0.779]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Obesity Overweight</td>
<td style="text-align: center;">1.161 [1.100, 1.226]***</td>
<td style="text-align: center;">1.112 [1.022, 1.210]*</td>
<td style="text-align: center;">1.138 [1.100, 1.177]***</td>
<td style="text-align: center;">1.266 [1.148, 1.397]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dyslipidemia</td>
<td style="text-align: center;">1.044 [1.002, 1.087]*</td>
<td style="text-align: center;">1.073 [1.001, 1.150]*</td>
<td style="text-align: center;">1.041 [1.013, 1.069]**</td>
<td style="text-align: center;">1.171 [1.092, 1.256]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diabetes</td>
<td style="text-align: center;">1.041 [1.009, 1.073]*</td>
<td style="text-align: center;">1.004 [0.954, 1.057]</td>
<td style="text-align: center;">1.011 [0.992, 1.031]</td>
<td style="text-align: center;">0.966 [0.922, 1.013]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hypertension</td>
<td style="text-align: center;">1.068 [1.039, 1.099]***</td>
<td style="text-align: center;">1.029 [0.979, 1.081]</td>
<td style="text-align: center;">1.046 [1.027, 1.065]***</td>
<td style="text-align: center;">1.079 [1.029, 1.132]**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tobacco Related</td>
<td style="text-align: center;">1.113 [1.077, 1.150]***</td>
<td style="text-align: center;">1.039 [0.975, 1.108]</td>
<td style="text-align: center;">1.098 [1.073, 1.123]***</td>
<td style="text-align: center;">1.095 [1.032, 1.162]**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol Related</td>
<td style="text-align: center;">1.138 [1.086, 1.192]***</td>
<td style="text-align: center;">1.101 [0.988, 1.226]</td>
<td style="text-align: center;">1.071 [1.030, 1.113]***</td>
<td style="text-align: center;">1.202 [1.113, 1.298]***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nutritional Problems</td>
<td style="text-align: center;">1.205 [1.158, 1.255]***</td>
<td style="text-align: center;">1.171 [1.049, 1.307]**</td>
<td style="text-align: center;">1.332 [1.290, 1.375]***</td>
<td style="text-align: center;">1.234 [1.133, 1.343]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Liver Disease</td>
<td style="text-align: center;">1.080 [1.016, 1.148]*</td>
<td style="text-align: center;">1.229 [1.133, 1.332]***</td>
<td style="text-align: center;">1.177 [1.130, 1.226]***</td>
<td style="text-align: center;">1.111 [1.022, 1.207]*</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sleep Disorders</td>
<td style="text-align: center;">0.921 [0.773, 1.099]</td>
<td style="text-align: center;">1.246 [0.848, 1.830]</td>
<td style="text-align: center;">0.900 [0.812, 0.997]*</td>
<td style="text-align: center;">—</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cardiovascular</td>
<td style="text-align: center;">1.111 [1.066, 1.157]***</td>
<td style="text-align: center;">1.100 [1.016, 1.192]*</td>
<td style="text-align: center;">1.191 [1.157, 1.225]***</td>
<td style="text-align: center;">1.109 [1.026, 1.199]**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gastrointestinal</td>
<td style="text-align: center;">1.383 [1.337, 1.431]***</td>
<td style="text-align: center;">1.492 [1.367, 1.628]***</td>
<td style="text-align: center;">1.634 [1.586, 1.682]***</td>
<td style="text-align: center;">1.268 [1.181, 1.361]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Musculoskeletal</td>
<td style="text-align: center;">0.924 [0.824, 1.036]</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">0.943 [0.876, 1.017]</td>
<td style="text-align: center;">1.031 [0.857, 1.239]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mental Health</td>
<td style="text-align: center;">1.322 [1.232, 1.418]***</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">1.197 [1.147, 1.250]***</td>
<td style="text-align: center;">1.208 [1.081, 1.351]***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Substance Use</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">1.406 [0.981, 2.016]</td>
<td style="text-align: center;">—</td>
<td style="text-align: center;">—</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Values shown as IRR [95% CI]</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Models include only comorbidities significant at p&lt;0.05 in bivariate analysis</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Reference categories: Male sex, Others service, Year 2019, Low severity, Low mortality risk</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance tables for refined models</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>log_perf_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(logistic_performance_refined)) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  perf <span class="ot">&lt;-</span> logistic_performance_refined[[cancer]]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  log_perf_summary <span class="ot">&lt;-</span> <span class="fu">rbind</span>(log_perf_summary,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cancer =</span> cancer,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">N Comorbidities</span><span class="st">`</span> <span class="ot">=</span> perf<span class="sc">$</span>N_Comorbidities,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> <span class="fu">format</span>(perf<span class="sc">$</span>N, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">Events =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, perf<span class="sc">$</span>Events, perf<span class="sc">$</span>EventRate),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">AIC =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, perf<span class="sc">$</span>AIC),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">BIC =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, perf<span class="sc">$</span>BIC),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">AUC =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, perf<span class="sc">$</span>AUC),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">McFadden =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, perf<span class="sc">$</span>McFadden),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Nagelkerke =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, perf<span class="sc">$</span>Nagelkerke)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>nb_perf_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(nb_performance_refined)) {</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  perf <span class="ot">&lt;-</span> nb_performance_refined[[cancer]]</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  nb_perf_summary <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nb_perf_summary,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cancer =</span> cancer,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">N Comorbidities</span><span class="st">`</span> <span class="ot">=</span> perf<span class="sc">$</span>N_Comorbidities,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> <span class="fu">format</span>(perf<span class="sc">$</span>N, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">MeanLOS =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f (%.1f)"</span>, perf<span class="sc">$</span>MeanLOS, perf<span class="sc">$</span>SDLOS),</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">AIC =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, perf<span class="sc">$</span>AIC),</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">BIC =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, perf<span class="sc">$</span>BIC),</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, perf<span class="sc">$</span>RMSE),</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">MAE =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, perf<span class="sc">$</span>MAE),</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">McFadden =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, perf<span class="sc">$</span>McFadden)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(log_perf_summary,</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"&lt;b&gt;Table: Performance Metrics - Negative Binomial Mixed Models&lt;/b&gt;"</span>,</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">font_size =</span> <span class="dv">11</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#16a085"</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption><strong>Table: Performance Metrics - Negative Binomial Mixed Models</strong></caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Cancer</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">N.Comorbidities</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">N</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Events</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">AIC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">BIC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">AUC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">McFadden</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(22, 160, 133, 255) !important;">Nagelkerke</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Stomach</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">23,234</td>
<td style="text-align: left;">1827 (7.9%)</td>
<td style="text-align: left;">10138.2</td>
<td style="text-align: left;">10323.4</td>
<td style="text-align: left;">0.830</td>
<td style="text-align: left;">0.211</td>
<td style="text-align: left;">0.260</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gallbladder</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">6,645</td>
<td style="text-align: left;">736 (11.1%)</td>
<td style="text-align: left;">3993.4</td>
<td style="text-align: left;">4122.6</td>
<td style="text-align: left;">0.775</td>
<td style="text-align: left;">0.145</td>
<td style="text-align: left;">0.191</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Colorectal</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">45,856</td>
<td style="text-align: left;">2482 (5.4%)</td>
<td style="text-align: left;">14392.1</td>
<td style="text-align: left;">14601.7</td>
<td style="text-align: left;">0.870</td>
<td style="text-align: left;">0.257</td>
<td style="text-align: left;">0.298</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pancreas</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">7,500</td>
<td style="text-align: left;">901 (12.0%)</td>
<td style="text-align: left;">4685.9</td>
<td style="text-align: left;">4831.3</td>
<td style="text-align: left;">0.786</td>
<td style="text-align: left;">0.157</td>
<td style="text-align: left;">0.209</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(nb_perf_summary,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"&lt;b&gt;Table: Performance Metrics - Negative Binomial Mixed Models&lt;/b&gt;"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Cancer"</span>, <span class="st">"N Comorbidities"</span>, <span class="st">"N"</span>, <span class="st">"Mean LOS (SD)"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"RMSE"</span>, <span class="st">"MAE"</span>, <span class="st">"McFadden R²"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">font_size =</span> <span class="dv">11</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#d35400"</span>, <span class="at">color =</span> <span class="st">"white"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption><strong>Table: Performance Metrics - Negative Binomial Mixed Models</strong></caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">Cancer</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">N Comorbidities</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">N</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">Mean LOS (SD)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">AIC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">BIC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">RMSE</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">MAE</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(211, 84, 0, 255) !important;">McFadden R²</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Stomach</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">23,234</td>
<td style="text-align: left;">9.8 (14.1)</td>
<td style="text-align: left;">147434.4</td>
<td style="text-align: left;">147668.0</td>
<td style="text-align: left;">12.95</td>
<td style="text-align: left;">7.19</td>
<td style="text-align: left;">0.585</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gallbladder</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">6,645</td>
<td style="text-align: left;">9.7 (11.1)</td>
<td style="text-align: left;">43113.1</td>
<td style="text-align: left;">43303.5</td>
<td style="text-align: left;">10.41</td>
<td style="text-align: left;">6.75</td>
<td style="text-align: left;">0.484</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Colorectal</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">45,856</td>
<td style="text-align: left;">9.0 (12.8)</td>
<td style="text-align: left;">281631.0</td>
<td style="text-align: left;">281884.3</td>
<td style="text-align: left;">11.66</td>
<td style="text-align: left;">6.03</td>
<td style="text-align: left;">0.537</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pancreas</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">7,500</td>
<td style="text-align: left;">11.2 (14.7)</td>
<td style="text-align: left;">50291.3</td>
<td style="text-align: left;">50485.1</td>
<td style="text-align: left;">13.80</td>
<td style="text-align: left;">8.03</td>
<td style="text-align: left;">0.571</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPREHENSIVE PERFORMANCE METRICS AND VISUALIZATIONS</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==========================</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest Plots for Refined Models</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>all_logistic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(logistic_results_refined)) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> logistic_results_refined[[cancer]]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Cancer <span class="ot">&lt;-</span> cancer</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">clean_var_names</span>(df<span class="sc">$</span>Variable)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>Variable <span class="sc">!=</span> <span class="st">"Intercept"</span>, ]</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  all_logistic_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_logistic_data, df)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_logistic_data, </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> OR, <span class="at">y =</span> <span class="fu">reorder</span>(Variable, OR), <span class="at">color =</span> Cancer)) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> CI_Lower, <span class="at">xmax =</span> CI_Upper), </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="dv">0</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log"</span>, </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.1"</span>, <span class="st">"0.25"</span>, <span class="st">"0.5"</span>, <span class="st">"1.0"</span>, <span class="st">"2.0"</span>, <span class="st">"4.0"</span>, <span class="st">"8.0"</span>)) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Logistic Regression mixed models: Odds Ratios for Mortality by Cancer Type"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Only significant comorbidities included"</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Odds Ratio (95% CI)"</span>,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Cancer Type"</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-9.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>all_nb_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(nb_results_refined)) {</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> nb_results_refined[[cancer]]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Cancer <span class="ot">&lt;-</span> cancer</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">clean_var_names</span>(df<span class="sc">$</span>Variable)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>Variable <span class="sc">!=</span> <span class="st">"Intercept"</span>, ]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  all_nb_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_nb_data, df)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_nb_data, </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> IRR, <span class="at">y =</span> <span class="fu">reorder</span>(Variable, IRR), <span class="at">color =</span> Cancer)) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> CI_Lower, <span class="at">xmax =</span> CI_Upper), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="dv">0</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log"</span>, </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.5"</span>, <span class="st">"0.75"</span>, <span class="st">"1.0"</span>, <span class="st">"1.5"</span>, <span class="st">"2.0"</span>, <span class="st">"3.0"</span>)) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Negative Binomial Mixed Models: Incidence Rate Ratios for Length of Stay"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Only significant comorbidities included"</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"IRR (95% CI)"</span>,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Cancer Type"</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-10.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate comprehensive metrics</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>calculate_comprehensive_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(model, data, cancer_name) {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> data<span class="sc">$</span>egresar_fallecido</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(observed, pred_probs, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  auc_value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">auc</span>(roc_obj))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  coords_optimal <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_obj, <span class="st">"best"</span>, <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"threshold"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>), </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  optimal_threshold <span class="ot">&lt;-</span> coords_optimal<span class="sc">$</span>threshold</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  pred_labels <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;=</span> optimal_threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">confusionMatrix</span>(<span class="fu">factor</span>(pred_labels, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)), </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">factor</span>(observed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">positive =</span> <span class="st">"1"</span>))</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  tn <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cm<span class="sc">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  fp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cm<span class="sc">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cm<span class="sc">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  tp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cm<span class="sc">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  specificity <span class="ot">&lt;-</span> tn <span class="sc">/</span> (tn <span class="sc">+</span> fp)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> (tp <span class="sc">+</span> tn) <span class="sc">/</span> (tp <span class="sc">+</span> tn <span class="sc">+</span> fp <span class="sc">+</span> fn)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  ppv <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  npv <span class="ot">&lt;-</span> tn <span class="sc">/</span> (tn <span class="sc">+</span> fn)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (ppv <span class="sc">*</span> sensitivity) <span class="sc">/</span> (ppv <span class="sc">+</span> sensitivity)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  balanced_accuracy <span class="ot">&lt;-</span> (sensitivity <span class="sc">+</span> specificity) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  mcc_denominator <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((tp <span class="sc">+</span> fp) <span class="sc">*</span> (tp <span class="sc">+</span> fn) <span class="sc">*</span> (tn <span class="sc">+</span> fp) <span class="sc">*</span> (tn <span class="sc">+</span> fn))</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  mcc <span class="ot">&lt;-</span> <span class="cf">if</span>(mcc_denominator <span class="sc">==</span> <span class="dv">0</span>) <span class="dv">0</span> <span class="cf">else</span> ((tp <span class="sc">*</span> tn) <span class="sc">-</span> (fp <span class="sc">*</span> fn)) <span class="sc">/</span> mcc_denominator</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  brier_score <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_probs <span class="sc">-</span> observed)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  hl_test <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">hoslem.test</span>(observed, pred_probs, <span class="at">g =</span> <span class="dv">10</span>))</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>  null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(egresar_fallecido <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data, <span class="at">family =</span> binomial)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>  ll_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(model))</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>  ll_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model)</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  mcfadden <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (ll_full <span class="sc">/</span> ll_null)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  cox_snell <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">/</span>n) <span class="sc">*</span> (ll_null <span class="sc">-</span> ll_full))</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  nagelkerke <span class="ot">&lt;-</span> cox_snell <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> ll_null <span class="sc">/</span> n))</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cancer =</span> cancer_name,</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> n,</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">Events =</span> <span class="fu">sum</span>(observed),</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">EventRate =</span> <span class="fu">mean</span>(observed) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">AUC =</span> auc_value,</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sensitivity =</span> sensitivity,</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">Specificity =</span> specificity,</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">PPV =</span> ppv,</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">NPV =</span> npv,</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">Accuracy =</span> accuracy,</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">BalancedAccuracy =</span> balanced_accuracy,</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">F1Score =</span> f1_score,</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">MCC =</span> mcc,</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">BrierScore =</span> brier_score,</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">OptimalThreshold =</span> optimal_threshold,</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">HosmerLemeshow_Chi2 =</span> hl_test<span class="sc">$</span>statistic,</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">HosmerLemeshow_p =</span> hl_test<span class="sc">$</span>p.value,</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">McFadden =</span> mcfadden,</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">CoxSnell =</span> cox_snell,</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">Nagelkerke =</span> nagelkerke,</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">AIC =</span> <span class="fu">AIC</span>(model),</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">BIC =</span> <span class="fu">BIC</span>(model),</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">LogLik =</span> ll_full</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">roc_obj =</span> roc_obj,</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_probs =</span> pred_probs,</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">observed =</span> observed</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics for all refined models</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>all_metrics <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(logistic_models_refined)) {</span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>  all_metrics[[cancer]] <span class="ot">&lt;-</span> <span class="fu">calculate_comprehensive_metrics</span>(</span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>    logistic_models_refined[[cancer]], </span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>    datasets[[cancer]], </span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>    cancer</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive Performance Table</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>performance_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(all_metrics, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics))</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>performance_table <span class="sc">|&gt;</span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">format</span>(N, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Events =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(Events, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, EventRate), <span class="st">")"</span>),</span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">AUC =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, AUC),</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sensitivity =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, Sensitivity),</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">Specificity =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, Specificity),</span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">PPV =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, PPV),</span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">NPV =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, NPV),</span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">Accuracy =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, Accuracy),</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">BalancedAccuracy =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, BalancedAccuracy),</span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">F1Score =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, F1Score),</span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">MCC =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, MCC),</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">BrierScore =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, BrierScore),</span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">OptimalThreshold =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, OptimalThreshold),</span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">HosmerLemeshow =</span> <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, HosmerLemeshow_Chi2), <span class="st">" (p="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, HosmerLemeshow_p), <span class="st">")"</span>),</span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">McFadden =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, McFadden),</span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nagelkerke =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Nagelkerke),</span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, AIC),</span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, BIC)</span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Cancer, N, Events, AUC, Sensitivity, Specificity, PPV, NPV, </span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>         Accuracy, BalancedAccuracy, F1Score, MCC, BrierScore, </span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a>         OptimalThreshold, HosmerLemeshow, McFadden, Nagelkerke, AIC, BIC) <span class="sc">|&gt;</span></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"&lt;b&gt;Table: Comprehensive Performance Metrics for Logistic Regression Mixed Models&lt;/b&gt;"</span>,</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Cancer"</span>, <span class="st">"N"</span>, <span class="st">"Events (%)"</span>, <span class="st">"AUC"</span>, <span class="st">"Sens"</span>, <span class="st">"Spec"</span>, <span class="st">"PPV"</span>, <span class="st">"NPV"</span>, </span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Acc"</span>, <span class="st">"Bal Acc"</span>, <span class="st">"F1"</span>, <span class="st">"MCC"</span>, <span class="st">"Brier"</span>, <span class="st">"Threshold"</span>, </span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"H-L Test"</span>, <span class="st">"McF R²"</span>, <span class="st">"Nagel R²"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"#2c3e50"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="fu">c</span>(<span class="st">"Sens: Sensitivity; Spec: Specificity; PPV: Positive Predictive Value; NPV: Negative Predictive Value"</span>,</span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Acc: Accuracy; Bal Acc: Balanced Accuracy; MCC: Matthews Correlation Coefficient"</span>,</span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"H-L Test: Hosmer-Lemeshow goodness-of-fit test (p&gt;0.05 indicates good calibration)"</span>,</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"McF R²: McFadden R²; Nagel R²: Nagelkerke R²"</span>),</span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>           <span class="at">footnote_as_chunk =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption><strong>Table: Comprehensive Performance Metrics for Logistic Regression Mixed Models</strong></caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Cancer</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">N</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Events (%)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">AUC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Sens</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Spec</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">PPV</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">NPV</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Acc</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Bal Acc</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">F1</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">MCC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Brier</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Threshold</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">H-L Test</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">McF R²</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Nagel R²</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">AIC</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Stomach</td>
<td style="text-align: left;">23,234</td>
<td style="text-align: left;">1,827 (7.9%)</td>
<td style="text-align: left;">0.830</td>
<td style="text-align: left;">0.244</td>
<td style="text-align: left;">0.976</td>
<td style="text-align: left;">0.771</td>
<td style="text-align: left;">0.797</td>
<td style="text-align: left;">0.795</td>
<td style="text-align: left;">0.610</td>
<td style="text-align: left;">0.371</td>
<td style="text-align: left;">0.354</td>
<td style="text-align: left;">0.0622</td>
<td style="text-align: left;">0.107</td>
<td style="text-align: left;">25.22 (p=0.001)</td>
<td style="text-align: left;">0.2114</td>
<td style="text-align: left;">0.2596</td>
<td style="text-align: left;">10138.2</td>
<td style="text-align: left;">10323.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gallbladder</td>
<td style="text-align: left;">6,645</td>
<td style="text-align: left;">736 (11.1%)</td>
<td style="text-align: left;">0.775</td>
<td style="text-align: left;">0.236</td>
<td style="text-align: left;">0.960</td>
<td style="text-align: left;">0.768</td>
<td style="text-align: left;">0.690</td>
<td style="text-align: left;">0.698</td>
<td style="text-align: left;">0.598</td>
<td style="text-align: left;">0.360</td>
<td style="text-align: left;">0.299</td>
<td style="text-align: left;">0.0875</td>
<td style="text-align: left;">0.090</td>
<td style="text-align: left;">12.94 (p=0.114)</td>
<td style="text-align: left;">0.1450</td>
<td style="text-align: left;">0.1915</td>
<td style="text-align: left;">3993.4</td>
<td style="text-align: left;">4122.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Colorectal</td>
<td style="text-align: left;">45,856</td>
<td style="text-align: left;">2,482 (5.4%)</td>
<td style="text-align: left;">0.870</td>
<td style="text-align: left;">0.206</td>
<td style="text-align: left;">0.986</td>
<td style="text-align: left;">0.800</td>
<td style="text-align: left;">0.824</td>
<td style="text-align: left;">0.822</td>
<td style="text-align: left;">0.596</td>
<td style="text-align: left;">0.328</td>
<td style="text-align: left;">0.346</td>
<td style="text-align: left;">0.0435</td>
<td style="text-align: left;">0.068</td>
<td style="text-align: left;">38.33 (p=0.000)</td>
<td style="text-align: left;">0.2569</td>
<td style="text-align: left;">0.2984</td>
<td style="text-align: left;">14392.1</td>
<td style="text-align: left;">14601.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pancreas</td>
<td style="text-align: left;">7,500</td>
<td style="text-align: left;">901 (12.0%)</td>
<td style="text-align: left;">0.786</td>
<td style="text-align: left;">0.271</td>
<td style="text-align: left;">0.953</td>
<td style="text-align: left;">0.737</td>
<td style="text-align: left;">0.730</td>
<td style="text-align: left;">0.731</td>
<td style="text-align: left;">0.612</td>
<td style="text-align: left;">0.397</td>
<td style="text-align: left;">0.324</td>
<td style="text-align: left;">0.0927</td>
<td style="text-align: left;">0.118</td>
<td style="text-align: left;">7.87 (p=0.446)</td>
<td style="text-align: left;">0.1569</td>
<td style="text-align: left;">0.2092</td>
<td style="text-align: left;">4685.9</td>
<td style="text-align: left;">4831.3</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Sens: Sensitivity; Spec: Specificity; PPV: Positive Predictive Value; NPV: Negative Predictive Value</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Acc: Accuracy; Bal Acc: Balanced Accuracy; MCC: Matthews Correlation Coefficient</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> H-L Test: Hosmer-Lemeshow goodness-of-fit test (p&gt;0.05 indicates good calibration)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> McF R²: McFadden R²; Nagel R²: Nagelkerke R²</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC Curves for refined models</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>roc_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(all_metrics)) {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  roc_obj <span class="ot">&lt;-</span> all_metrics[[cancer]]<span class="sc">$</span>roc_obj</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  roc_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(roc_data,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">FPR =</span> <span class="dv">1</span> <span class="sc">-</span> roc_obj<span class="sc">$</span>specificities,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">TPR =</span> roc_obj<span class="sc">$</span>sensitivities,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cancer =</span> cancer,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">AUC =</span> <span class="fu">as.numeric</span>(<span class="fu">auc</span>(roc_obj))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>auc_labels <span class="ot">&lt;-</span> roc_data <span class="sc">|&gt;</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cancer) <span class="sc">|&gt;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AUC =</span> <span class="fu">first</span>(AUC)) <span class="sc">|&gt;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Cancer, <span class="st">" (AUC = "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, AUC), <span class="st">")"</span>))</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>p_roc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(roc_data, <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> TPR, <span class="at">color =</span> Cancer)) <span class="sc">+</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">labels =</span> auc_labels<span class="sc">$</span>label) <span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"ROC Curves for In-Hospital Mortality Prediction - Mixed Models"</span>,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Mixed Logistic Regression with Significant Comorbidities Only"</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"False Positive Rate (1 - Specificity)"</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"True Positive Rate (Sensitivity)"</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">""</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_roc)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-11.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calibration Plots</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>create_calibration_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(pred_probs, observed, cancer_name, <span class="at">n_groups =</span> <span class="dv">10</span>) {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  prob_groups <span class="ot">&lt;-</span> <span class="fu">cut</span>(pred_probs, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">quantile</span>(pred_probs, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span>n_groups)),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  calib_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> prob_groups,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_prob =</span> pred_probs,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">observed =</span> observed</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_pred =</span> <span class="fu">mean</span>(pred_prob),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_obs =</span> <span class="fu">mean</span>(observed),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">se_obs =</span> <span class="fu">sqrt</span>(mean_obs <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> mean_obs) <span class="sc">/</span> n),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_lower =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, mean_obs <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_obs),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_upper =</span> <span class="fu">pmin</span>(<span class="dv">1</span>, mean_obs <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se_obs),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(calib_data, <span class="fu">aes</span>(<span class="at">x =</span> mean_pred, <span class="at">y =</span> mean_obs)) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Calibration Plot -"</span>, cancer_name),</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Mean Predicted Probability"</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Observed Proportion"</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="st">"n"</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>calib_plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(cancer <span class="cf">in</span> <span class="fu">names</span>(all_metrics)) {</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  calib_plots[[cancer]] <span class="ot">&lt;-</span> <span class="fu">create_calibration_plot</span>(</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    all_metrics[[cancer]]<span class="sc">$</span>pred_probs,</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    all_metrics[[cancer]]<span class="sc">$</span>observed,</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>    cancer</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>p_calibration <span class="ot">&lt;-</span> <span class="fu">wrap_plots</span>(calib_plots, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Calibration Assessment - Mixed Models"</span>,</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_calibration)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-12.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance Comparison Visualization</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>perf_long <span class="ot">&lt;-</span> performance_table <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Cancer, AUC, Sensitivity, Specificity, F1Score, MCC) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Cancer, <span class="at">names_to =</span> <span class="st">"Metric"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>p_performance <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(perf_long, <span class="fu">aes</span>(<span class="at">x =</span> Cancer, <span class="at">y =</span> Value, <span class="at">fill =</span> Metric)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Performance Metrics Comparison - Mixed Models"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cancer Type"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Metric Value"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Metric"</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_performance)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-1-13.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Arnold2020" class="csl-entry" role="listitem">
1. Arnold, M., Abnet, C. C., Neale, R. E., Vignat, J., Giovannucci, E. L., McGlynn, K. A., &amp; Bray, F. (2020). Global Burden of 5 Major Types of Gastrointestinal Cancer. <em>Gastroenterology</em>, <em>159</em>(1), 335-349.e15. <a href="https://doi.org/10.1053/j.gastro.2020.02.068">https://doi.org/10.1053/j.gastro.2020.02.068</a>
</div>
<div id="ref-Keum2019" class="csl-entry" role="listitem">
2. Keum, N., &amp; Giovannucci, E. (2019). Global burden of colorectal cancer: emerging trends, risk factors and prevention. <em>Nature Reviews Gastroenterology &amp; Hepatology</em>, <em>16</em>(12), 713-732. <a href="https://doi.org/10.1038/s41575-019-0189-8">https://doi.org/10.1038/s41575-019-0189-8</a>
</div>
<div id="ref-Mondschein2022" class="csl-entry" role="listitem">
3. Mondschein, S., Subiabre, F., Yankovic, N., Estay, C., Von Mühlenbrock, C., &amp; Berger, Z. (2022). Colorectal cancer trends in Chile: A Latin-American country with marked socioeconomic inequities. <em>PLOS ONE</em>, <em>17</em>(11), e0271929. <a href="https://doi.org/10.1371/journal.pone.0271929">https://doi.org/10.1371/journal.pone.0271929</a>
</div>
<div id="ref-Rios2020" class="csl-entry" role="listitem">
4. Rı́os, J. A., Barake, M. F., Arce, M. J., López-Köstner, F., Labbé, T. P., Villena, J., &amp; Becerra, S. (2020). Situaci<span>ó</span>n actual del c<span>á</span>ncer de colon en Chile: una mirada traslacional. <em>Revista M<span>é</span>dica de Chile</em>, <em>148</em>(6), 858-867. <a href="https://doi.org/10.4067/S0034-98872020000600858">https://doi.org/10.4067/S0034-98872020000600858</a>
</div>
<div id="ref-Caglevic2016" class="csl-entry" role="listitem">
5. Caglevic, C., Silva, S., Mahave, M., Rolfo, C., &amp; Gallardo, J. (2016). The current situation for gastric cancer in Chile. <em>ecancermedicalscience</em>, <em>10</em>, 707. <a href="https://doi.org/10.3332/ecancer.2016.707">https://doi.org/10.3332/ecancer.2016.707</a>
</div>
<div id="ref-GBD2017_Pancreas2019" class="csl-entry" role="listitem">
6. GBD 2017 Pancreatic Cancer Collaborators. (2019). The global, regional, and national burden of pancreatic cancer and its attributable risk factors in 195 countries and territories, 1990–2017. <em>The Lancet Gastroenterology &amp; Hepatology</em>, <em>4</em>(12), 934-947. <a href="https://doi.org/10.1016/S2468-1253(19)30347-4">https://doi.org/10.1016/S2468-1253(19)30347-4</a>
</div>
<div id="ref-Olivares2016" class="csl-entry" role="listitem">
7. Villanueva Olivares, L. (2016). Cancer of the gallbladder—Chilean statistics. <em>ecancermedicalscience</em>, <em>10</em>, 704. <a href="https://doi.org/10.3332/ecancer.2016.704">https://doi.org/10.3332/ecancer.2016.704</a>
</div>
<div id="ref-Koshiol2020" class="csl-entry" role="listitem">
8. Koshiol, J., Ferreccio, C., Manhartsberger, M., &amp; al., et. (2020). The Chile Biliary Longitudinal Study (BiLS): design and rationale. <em>Revista Panamericana de Salud P<span>ú</span>blica</em>, <em>44</em>, e86. <a href="https://doi.org/10.26633/RPSP.2020.86">https://doi.org/10.26633/RPSP.2020.86</a>
</div>
<div id="ref-WCRF2018" class="csl-entry" role="listitem">
9. World Cancer Research Fund/American Institute for Cancer Research. (2018). <em>Diet, Nutrition, Physical Activity and Cancer: a Global Perspective (Third Expert Report)</em>. WCRF/AICR. <a href="https://www.wcrf.org/diet-activity-and-cancer/">https://www.wcrf.org/diet-activity-and-cancer/</a>
</div>
<div id="ref-WCRF2018_CRC" class="csl-entry" role="listitem">
10. WCRF/AICR Continuous Update Project. (2018). <em>Diet, Nutrition, Physical Activity and Colorectal Cancer</em>. World Cancer Research Fund International. <a href="https://www.wcrf.org/diet-and-cancer/colorectal-cancer/">https://www.wcrf.org/diet-and-cancer/colorectal-cancer/</a>
</div>
<div id="ref-Bouvard2015" class="csl-entry" role="listitem">
11. Bouvard, V., Loomis, D., Guyton, K. Z., &amp; al., et. (2015). Carcinogenicity of consumption of red and processed meat. <em>The Lancet Oncology</em>, <em>16</em>(16), 1599-1600. <a href="https://doi.org/10.1016/S1470-2045(15)00444-1">https://doi.org/10.1016/S1470-2045(15)00444-1</a>
</div>
<div id="ref-LaubySecretan2016" class="csl-entry" role="listitem">
12. Lauby-Secretan, B., Scoccianti, C., Loomis, D., Bianchini, F., &amp; Straif, K. (2016). Body Fatness and Cancer—Viewpoint of the IARC Working Group. <em>New England Journal of Medicine</em>, <em>375</em>(8), 794-798. <a href="https://doi.org/10.1056/NEJMsr1606602">https://doi.org/10.1056/NEJMsr1606602</a>
</div>
<div id="ref-Bagnardi2015" class="csl-entry" role="listitem">
13. Bagnardi, V., Rota, M., Botteri, E., &amp; al., et. (2015). Alcohol consumption and site-specific cancer risk: a comprehensive dose–response meta-analysis. <em>Annals of Oncology</em>, <em>26</em>(4), 756-770. <a href="https://doi.org/10.1093/annonc/mdu223">https://doi.org/10.1093/annonc/mdu223</a>
</div>
<div id="ref-IARC2014" class="csl-entry" role="listitem">
14. IARC Working Group Report No. 8. (2014). <em>Helicobacter pylori Eradication as a Strategy for Preventing Gastric Cancer</em>. International Agency for Research on Cancer. <a href="https://publications.iarc.fr/Book-And-Report-Series/Iarc-Working-Group-Reports/Helicobacter-Pylori-Eradication-As-A-Strategy-For-Preventing-Gastric-Cancer-2014">https://publications.iarc.fr/Book-And-Report-Series/Iarc-Working-Group-Reports/Helicobacter-Pylori-Eradication-As-A-Strategy-For-Preventing-Gastric-Cancer-2014</a>
</div>
<div id="ref-Ford2014" class="csl-entry" role="listitem">
15. Ford, A. C., Forman, D., Hunt, R. H., Yuan, Y., &amp; Moayyedi, P. (2014). Helicobacter pylori eradication therapy to prevent gastric cancer in healthy asymptomatic infected individuals: systematic review and meta-analysis of randomised controlled trials. <em>BMJ</em>, <em>348</em>, g3174. <a href="https://doi.org/10.1136/bmj.g3174">https://doi.org/10.1136/bmj.g3174</a>
</div>
<div id="ref-Bachelet2018" class="csl-entry" role="listitem">
16. Bachelet, V. C., &amp; Lanas, F. (2018). Smoking and obesity in Chile’s Third National Health Survey: light and shade. <em>Revista Panamericana de Salud P<span>ú</span>blica</em>, <em>42</em>, e132. <a href="https://doi.org/10.26633/RPSP.2018.132">https://doi.org/10.26633/RPSP.2018.132</a>
</div>
<div id="ref-WHO2025" class="csl-entry" role="listitem">
17. World Health Organization. (2025). <em>Cancer: Key facts (updated 3 February 2025)</em>. <a href="https://www.who.int/news-room/fact-sheets/detail/cancer" class="uri">https://www.who.int/news-room/fact-sheets/detail/cancer</a>.
</div>
<div id="ref-MartinezMardones2022_RevCir" class="csl-entry" role="listitem">
18. Martı́nez-Mardones, F., Astudillo, P., Quiroga, M., &amp; al., et. (2022). Enhanced Recovery After Surgery in Colorectal Surgery: Implementation and Outcomes in a Chilean Hospital. <em>Revista de Cirug<span>ı́</span>a</em>, <em>74</em>(1), 28-36. <a href="https://doi.org/10.35687/s2452-454920220061644">https://doi.org/10.35687/s2452-454920220061644</a>
</div>
<div id="ref-Huisman2024_AOSOpen" class="csl-entry" role="listitem">
19. Huisman, D. E., Ingwersen, E. W., &amp; al., et. (2024). Prediction of Length of Stay After Colorectal Surgery Using Intraoperative Risk Factors. <em>Annals of Surgery Open</em>, <em>—</em>, e000—. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC11415119/">https://pmc.ncbi.nlm.nih.gov/articles/PMC11415119/</a>
</div>
<div id="ref-Norero2015_RevMedChile" class="csl-entry" role="listitem">
20. Norero, E., Pérez, G., Muñoz, R., &amp; al., et. (2015). Totally laparoscopic gastrectomy for malignant disease: initial experience in a Chilean tertiary hospital. <em>Revista M<span>é</span>dica de Chile</em>, <em>143</em>(3), 316-324. <a href="https://doi.org/10.4067/S0034-98872015000300001">https://doi.org/10.4067/S0034-98872015000300001</a>
</div>
<div id="ref-vanDerVeen2021_LOGICA" class="csl-entry" role="listitem">
21. Veen, A. van der, Brenkman, H. J. F., Seesing, M. F. J., &amp; al., et. (2021). Laparoscopic versus open gastrectomy for gastric cancer (LOGICA): a multicenter randomized clinical trial. <em>Journal of Clinical Oncology</em>, <em>39</em>(9), 978-989. <a href="https://doi.org/10.1200/JCO.20.01540">https://doi.org/10.1200/JCO.20.01540</a>
</div>
<div id="ref-Losada2024_RevCir_Blumgart" class="csl-entry" role="listitem">
22. Losada, H., Barrera, C., Maluenda, F., &amp; Chahuán, C. (2024). Pancreatoduodenectomy with Blumgart pancreatojejunostomy: results of a consecutive series. <em>Revista de Cirug<span>ı́</span>a</em>, <em>76</em>(5), 422-427. <a href="https://revistacirugia.cl/index.php/revistacirugia/article/view/2185">https://revistacirugia.cl/index.php/revistacirugia/article/view/2185</a>
</div>
<div id="ref-Bjornsson2020_LAPOP" class="csl-entry" role="listitem">
23. Björnsson, B., Lindhoff Larsson, A., Hjalmarsson, C., Gasslander, T., &amp; Sandström, P. (2020). Comparison of hospital stay after laparoscopic versus open distal pancreatectomy: randomized controlled trial. <em>British Journal of Surgery</em>, <em>107</em>(10), 1281-1288. <a href="https://doi.org/10.1002/bjs.11554">https://doi.org/10.1002/bjs.11554</a>
</div>
<div id="ref-Kuemmerli2022_BJS" class="csl-entry" role="listitem">
24. Kuemmerli, C., Abu Hilal, M., &amp; al., et. (2022). Enhanced recovery after pancreatoduodenectomy: a systematic review and meta-analysis. <em>British Journal of Surgery</em>, <em>109</em>(7), e88-e99. <a href="https://doi.org/10.1093/bjs/znac094">https://doi.org/10.1093/bjs/znac094</a>
</div>
<div id="ref-Melloul2020_ERAS_PDAC" class="csl-entry" role="listitem">
25. Melloul, E., Lassen, K., Roulin, D., &amp; al., et. (2020). Guidelines for Perioperative Care for Pancreatoduodenectomy: Enhanced Recovery After Surgery (ERAS) Society Recommendations. <em>World Journal of Surgery</em>, <em>44</em>(7), 2056-2084. <a href="https://doi.org/10.1007/s00268-020-05462-1">https://doi.org/10.1007/s00268-020-05462-1</a>
</div>
<div id="ref-Vega2023_ASO_IGBC" class="csl-entry" role="listitem">
26. Vega, E. A., Aretxabala, X. de, Vinuela, E., &amp; al., et. (2023). Extent of Liver Resection for Incidental Gallbladder Cancer: Oncologic and Morbidity Trade-offs. <em>Annals of Surgical Oncology</em>, —. <a href="https://doi.org/10.1245/s10434-023-13861-1">https://doi.org/10.1245/s10434-023-13861-1</a>
</div>
<div id="ref-Nakanishi2022_AJS" class="csl-entry" role="listitem">
27. Nakanishi, H., &amp; al., et. (2022). Laparoscopic versus open surgery for gallbladder cancer: a systematic review and meta-analysis. <em>American Journal of Surgery</em>, <em>224</em>, —. <a href="https://doi.org/10.1016/j.amjsurg.2022.05.038">https://doi.org/10.1016/j.amjsurg.2022.05.038</a>
</div>
<div id="ref-Lee2022_LapExtendedChole" class="csl-entry" role="listitem">
28. Lee, J. W., &amp; al., et. (2022). Oncologic and Long-Term Outcomes of Laparoscopic Extended Cholecystectomy for Gallbladder Cancer. <em>Cancers</em>, <em>14</em>(8), 2036. <a href="https://doi.org/10.3390/cancers14082036">https://doi.org/10.3390/cancers14082036</a>
</div>
<div id="ref-Zeng2024_FrontSurg" class="csl-entry" role="listitem">
29. Zeng, D., &amp; al., et. (2024). Incidental gallbladder cancer detected during laparoscopic cholecystectomy: perioperative outcomes by approach. <em>Frontiers in Surgery</em>, <em>11</em>, 1418314. <a href="https://doi.org/10.3389/fsurg.2024.1418314">https://doi.org/10.3389/fsurg.2024.1418314</a>
</div>
<div id="ref-Sauro2024_JAMAOpen" class="csl-entry" role="listitem">
30. Sauro, K. M., &amp; al., et. (2024). Enhanced Recovery After Surgery Guidelines and Hospital Length of Stay: Systematic Review and Meta-analysis of Randomized Trials. <em>JAMA Network Open</em>, <em>7</em>(—), e—. <a href="https://jamanetwork.com/journals/jamanetworkopen/fullarticle/2820097">https://jamanetwork.com/journals/jamanetworkopen/fullarticle/2820097</a>
</div>
<div id="ref-Gysling2024_AOSOpen" class="csl-entry" role="listitem">
31. Gysling, S., Lobo, D. N., &amp; al., et. (2024). The effect of diabetes mellitus on perioperative outcomes after colorectal resection: a national cohort study. <em>Annals of Surgery Open</em>, <em>—</em>, —. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC11213983/">https://pmc.ncbi.nlm.nih.gov/articles/PMC11213983/</a>
</div>
<div id="ref-Zhang2023_CMRO" class="csl-entry" role="listitem">
32. Zhang, X., Li, W., Chen, Q., &amp; al., et. (2023). Comorbidity burden and outcomes after colorectal cancer surgery: a cohort study using the Charlson Comorbidity Index. <em>Current Medical Research and Opinion</em>, <em>39</em>(4), 605-614. <a href="https://doi.org/10.1080/03007995.2022.2139053">https://doi.org/10.1080/03007995.2022.2139053</a>
</div>
<div id="ref-Tian2017_CCI_CRC" class="csl-entry" role="listitem">
33. Tian, Y., Yang, J., Ma, L., &amp; al., et. (2017). Age-adjusted Charlson comorbidity index score as a predictor of outcomes after colorectal cancer surgery. <em>Oncotarget</em>, <em>8</em>, —. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC5400545/">https://pmc.ncbi.nlm.nih.gov/articles/PMC5400545/</a>
</div>
<div id="ref-Gurunathan2017_JOGS" class="csl-entry" role="listitem">
34. Gurunathan, U., Rapchuk, I., Fraser, J., &amp; al., et. (2017). Association Between Obesity and Wound Infection After Colorectal Surgery: A Systematic Review and Meta-analysis. <em>Journal of Gastrointestinal Surgery</em>, <em>21</em>(10), 1700-1712. <a href="https://doi.org/10.1007/s11605-017-3473-9">https://doi.org/10.1007/s11605-017-3473-9</a>
</div>
<div id="ref-Irani2023_ASCRS" class="csl-entry" role="listitem">
35. Irani, J. L., Steele, S. R., &amp; American Society of Colon and Rectal Surgeons. (2023). <em>Clinical Practice Guidelines for Enhanced Recovery After Colon and Rectal Surgery</em>. <a href="https://fascrs.org/ascrs/media/files/Education/2023-Enhanced-Recovery-CPG.pdf" class="uri">https://fascrs.org/ascrs/media/files/Education/2023-Enhanced-Recovery-CPG.pdf</a>.
</div>
<div id="ref-Tsekrekos2022_GastricBMI" class="csl-entry" role="listitem">
36. Tsekrekos, A., Theodorou, D., &amp; al., et. (2022). Impact of obesity on outcomes after gastrectomy for gastric cancer: a meta-analysis. <em>Asian Journal of Surgery</em>, <em>45</em>, —. <a href="https://doi.org/10.1016/j.asjsur.2021.09.032">https://doi.org/10.1016/j.asjsur.2021.09.032</a>
</div>
<div id="ref-Zhao2025_WJG" class="csl-entry" role="listitem">
37. Zhao, L., Wang, H., &amp; al., et. (2025). Impact of diabetes on recovery after radical gastrectomy for gastric cancer. <em>World Journal of Gastroenterology</em>, <em>—</em>(—), —. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC11948120/">https://pmc.ncbi.nlm.nih.gov/articles/PMC11948120/</a>
</div>
<div id="ref-Ramsey2011_JOGS" class="csl-entry" role="listitem">
38. Ramsey, A. M., Martin, R. C. G., &amp; al., et. (2011). Body Mass Index and Outcomes from Pancreatic Resection. <em>Journal of Gastrointestinal Surgery</em>, <em>15</em>(11), 1889-1895. <a href="https://doi.org/10.1007/s11605-011-1657-8">https://doi.org/10.1007/s11605-011-1657-8</a>
</div>
<div id="ref-Hajibandeh2025_ObesityPancreatectomy" class="csl-entry" role="listitem">
39. Hajibandeh, S., &amp; al., et. (2025). Obesity is associated with adverse outcomes after pancreatic resection: a meta-analysis. <em>International Journal of Surgery</em>, <em>—</em>(—), —. <a href="https://doi.org/10.1016/j.ijsu.2024.107021">https://doi.org/10.1016/j.ijsu.2024.107021</a>
</div>
<div id="ref-Zhao2023_TP" class="csl-entry" role="listitem">
40. Zhao, T., Wang, W., &amp; al., et. (2023). Diabetes management in patients undergoing total pancreatectomy. <em>World Journal of Clinical Cases</em>, <em>11</em>(7), 1512-1526. <a href="https://doi.org/10.12998/wjcc.v11.i7.1512">https://doi.org/10.12998/wjcc.v11.i7.1512</a>
</div>
<div id="ref-ford2012" class="csl-entry" role="listitem">
41. Ford, E. S., Bergmann, M. M., Boeing, H., Li, C., &amp; Capewell, S. (2012). Healthy lifestyle behaviors and all-cause mortality among adults in the United States. <em>Preventive Medicine</em>, <em>55</em>(1), 23-27. <a href="https://doi.org/10.1016/j.ypmed.2012.04.016">https://doi.org/10.1016/j.ypmed.2012.04.016</a>
</div>
<div id="ref-agresti2019" class="csl-entry" role="listitem">
42. Agresti, A. (2019). <em>An Introduction to Categorical Data Analysis</em> (3.ª ed.). John Wiley &amp; Sons.
</div>
<div id="ref-hollander2013" class="csl-entry" role="listitem">
43. Hollander, M., Wolfe, D. A., &amp; Chicken, E. (2013). <em>Nonparametric Statistical Methods</em> (3.ª ed.). John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9781119196037">https://doi.org/10.1002/9781119196037</a>
</div>
<div id="ref-breslow1993" class="csl-entry" role="listitem">
44. Breslow, N. E., &amp; Clayton, D. G. (1993). Approximate inference in generalized linear mixed models. <em>Journal of the American Statistical Association</em>, <em>88</em>(421), 9-25. <a href="https://doi.org/10.1080/01621459.1993.10594284">https://doi.org/10.1080/01621459.1993.10594284</a>
</div>
<div id="ref-harrell2015" class="csl-entry" role="listitem">
45. Harrell, F. E. (2015). <em>Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis</em> (2.ª ed.). Springer. <a href="https://doi.org/10.1007/978-3-319-19425-7">https://doi.org/10.1007/978-3-319-19425-7</a>
</div>
<div id="ref-hilbe2011" class="csl-entry" role="listitem">
46. Hilbe, J. M. (2011). <em>Negative Binomial Regression</em> (2.ª ed.). Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511973420">https://doi.org/10.1017/CBO9780511973420</a>
</div>
<div id="ref-hanley1982" class="csl-entry" role="listitem">
47. Hanley, J. A., &amp; McNeil, B. J. (1982). The meaning and use of the area under a receiver operating characteristic (ROC) curve. <em>Radiology</em>, <em>143</em>(1), 29-36. <a href="https://doi.org/10.1148/radiology.143.1.7063747">https://doi.org/10.1148/radiology.143.1.7063747</a>
</div>
<div id="ref-hosmer2013" class="csl-entry" role="listitem">
48. Hosmer, D. W., Lemeshow, S., &amp; Sturdivant, R. X. (2013). <em>Applied Logistic Regression</em> (3.ª ed.). John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9781118548387">https://doi.org/10.1002/9781118548387</a>
</div>
<div id="ref-nagelkerke1991" class="csl-entry" role="listitem">
49. Nagelkerke, N. J. (1991). A note on a general definition of the coefficient of determination. <em>Biometrika</em>, <em>78</em>(3), 691-692. <a href="https://doi.org/10.1093/biomet/78.3.691">https://doi.org/10.1093/biomet/78.3.691</a>
</div>
<div id="ref-matthews1975" class="csl-entry" role="listitem">
50. Matthews, B. W. (1975). Comparison of the predicted and observed secondary structure of T4 phage lysozyme. <em>Biochimica et Biophysica Acta (BBA)-Protein Structure</em>, <em>405</em>(2), 442-451. <a href="https://doi.org/10.1016/0005-2795(75)90109-9">https://doi.org/10.1016/0005-2795(75)90109-9</a>
</div>
<div id="ref-brier1950" class="csl-entry" role="listitem">
51. Brier, G. W. (1950). Verification of forecasts expressed in terms of probability. <em>Monthly Weather Review</em>, <em>78</em>(1), 1-3. <a href="https://doi.org/10.1175/1520-0493(1950)078<0001:VOFEIT>2.0.CO;2">https://doi.org/10.1175/1520-0493(1950)078&lt;0001:VOFEIT&gt;2.0.CO;2</a>
</div>
<div id="ref-youden1950" class="csl-entry" role="listitem">
52. Youden, W. J. (1950). Index for rating diagnostic tests. <em>Cancer</em>, <em>3</em>(1), 32-35. <a href="https://doi.org/10.1002/1097-0142(1950)3:1<32::AID-CNCR2820030106>3.0.CO;2-3">https://doi.org/10.1002/1097-0142(1950)3:1&lt;32::AID-CNCR2820030106&gt;3.0.CO;2-3</a>
</div>
<div id="ref-rothman1990" class="csl-entry" role="listitem">
53. Rothman, K. J. (1990). No adjustments are needed for multiple comparisons. <em>Epidemiology</em>, <em>1</em>(1), 43-46. <a href="https://doi.org/10.1097/00001648-199001000-00010">https://doi.org/10.1097/00001648-199001000-00010</a>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="stage1_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>